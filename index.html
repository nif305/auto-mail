<!doctype html>
<html lang="ar" dir="rtl">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ูุธุงู ุฅุฏุงุฑุฉ ุงููุฑุงุณูุงุช - ููุงูุฉ ุงูุชุฏุฑูุจ</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'nauss-green': '#166764',
                        'nauss-gold': '#cdb081',
                        'nauss-light': '#f0f4f3',
                        'nauss-dark': '#0f4c49'
                    }
                }
            }
        }
    </script>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&amp;display=swap" rel="stylesheet">
  <style>
        body {
            font-family: 'Cairo', sans-serif;
            box-sizing: border-box;
        }
        
        @media print {
            body * {
                visibility: hidden;
            }
            #letterDisplay, #letterDisplay * {
                visibility: visible;
            }
            #letterDisplay {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
            }
        }
    </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
  <script src="/_sdk/element_sdk.js" type="text/javascript"></script>
 </head>
 <body class="bg-gray-50"><!-- Header -->
  <header class="bg-nauss-green text-white shadow-lg relative">
   <div class="container mx-auto px-4 py-6">
    <div class="flex items-center justify-center mb-4"><img src="https://nauss.edu.sa/Style%20Library/ar-sa/Styles/images/home/logo-footer.png" alt="ุดุนุงุฑ ุฌุงูุนุฉ ูุงูู ุงูุนุฑุจูุฉ ููุนููู ุงูุฃูููุฉ" class="h-16 w-auto" onerror="this.style.display='none'; document.getElementById('fallbackLogo').style.display='block';">
     <div id="fallbackLogo" style="display: none;" class="w-16 h-16 bg-white rounded-full flex items-center justify-center"><span class="text-nauss-green font-bold text-lg">ูุงูู</span>
     </div>
    </div>
    <h1 class="text-2xl font-bold text-center">ูุธุงู ุฅุฏุงุฑุฉ ุงููุฑุงุณูุงุช</h1>
    <p class="text-center text-nauss-light mt-2">ููุงูุฉ ุงูุฌุงูุนุฉ ููุชุฏุฑูุจ</p><button onclick="openArchive()" class="absolute top-4 left-4 bg-white bg-opacity-20 hover:bg-opacity-30 text-white p-3 rounded-full transition-all duration-300 shadow-lg hover:shadow-xl group" title="ุฃุฑุดูู ุงููุนุงููุงุช">
     <svg class="w-6 h-6 group-hover:scale-110 transition-transform" fill="currentColor" viewbox="0 0 24 24"><path d="M3 4h18v2H3V4zm0 7h18v9a2 2 0 01-2 2H5a2 2 0 01-2-2v-9zm2 2v7h14v-7H5zm2 2h10v1H7v-1zm0 2h7v1H7v-1z" />
     </svg></button>
   </div>
  </header><!-- Main Content -->
  <main class="container mx-auto px-4 py-8">
   <div class="max-w-4xl mx-auto"><!-- Category Selection -->
    <div id="categorySelection" class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
     <div class="bg-white rounded-lg shadow-lg p-6 hover:shadow-xl cursor-pointer transition-all border-r-4 border-nauss-green" onclick="selectCategory('internal')">
      <div class="text-center">
       <div class="w-16 h-16 bg-nauss-green rounded-full flex items-center justify-center mx-auto mb-4"><span class="text-white text-2xl">๐</span>
       </div>
       <h3 class="text-xl font-bold text-nauss-green mb-3">ุงููุฑุงุณูุงุช ุงูุฏุงุฎููุฉ</h3>
       <p class="text-gray-600">ุฏุงุฎู ููุงูุฉ ุงูุชุฏุฑูุจ</p>
      </div>
     </div>
     <div class="bg-white rounded-lg shadow-lg p-6 hover:shadow-xl cursor-pointer transition-all border-r-4 border-nauss-gold" onclick="selectCategory('external')">
      <div class="text-center">
       <div class="w-16 h-16 bg-nauss-gold rounded-full flex items-center justify-center mx-auto mb-4"><span class="text-white text-2xl">๐ค</span>
       </div>
       <h3 class="text-xl font-bold text-nauss-gold mb-3">ุงููุฑุงุณูุงุช ุงูุฎุงุฑุฌูุฉ</h3>
       <p class="text-gray-600">ุฎุงุฑุฌ ููุงูุฉ ุงูุชุฏุฑูุจ</p>
      </div>
     </div>
    </div><!-- Letter Type Selection -->
    <div id="letterTypeSection" class="hidden">
     <div class="bg-white rounded-lg shadow-lg p-6 mb-8">
      <div class="flex items-center justify-between mb-6">
       <h3 class="text-xl font-bold text-nauss-green">ุงุฎุชุฑ ููุน ุงููุฑุงุณูุฉ</h3><button onclick="goBack()" class="text-gray-500 hover:text-nauss-green">ุงูุนูุฏุฉ</button>
      </div>
      <div class="mb-6"><select id="letterType" onchange="handleLetterTypeChange()" class="w-full p-3 border border-gray-300 rounded-lg focus:border-nauss-green focus:outline-none"> <option value="">-- ุงุฎุชุฑ ููุน ุงููุฑุงุณูุฉ --</option> </select>
      </div>
      <div id="formFields" class="hidden">
       <h4 class="text-lg font-bold text-nauss-green mb-4">ุจูุงูุงุช ุงููุฑุงุณูุฉ</h4>
       <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6" id="dynamicFields"></div><button onclick="generateLetter()" class="bg-nauss-green hover:bg-nauss-dark text-white px-6 py-3 rounded-lg font-bold transition-colors"> ุฅูุดุงุก ุงููุฑุงุณูุฉ </button>
      </div>
     </div>
    </div><!-- Archive Modal -->
    <div id="archiveModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
     <div class="bg-white rounded-lg shadow-2xl max-w-6xl w-full" style="max-height: 90%; overflow-y: auto;">
      <div class="bg-gradient-to-r from-nauss-green to-nauss-gold text-white p-6 sticky top-0 z-10">
       <div class="flex items-center justify-between">
        <h2 class="text-2xl font-bold flex items-center">
         <svg class="w-8 h-8 ml-3" fill="currentColor" viewbox="0 0 24 24"><path d="M3 4h18v2H3V4zm0 7h18v9a2 2 0 01-2 2H5a2 2 0 01-2-2v-9zm2 2v7h14v-7H5zm2 2h10v1H7v-1zm0 2h7v1H7v-1z" />
         </svg> ุฃุฑุดูู ุงููุนุงููุงุช</h2><button onclick="closeArchive()" class="text-white hover:text-gray-200 text-2xl font-bold">ร</button>
       </div>
      </div>
      <div class="p-6">
       <div class="mb-6 bg-gray-50 p-4 rounded-lg">
        <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
         <div><label class="block text-sm font-semibold text-gray-700 mb-2">ุงูุจุญุซ</label> <input type="text" id="archiveSearch" placeholder="ุงุจุญุซ ูู ุงููุนุงููุงุช..." class="w-full p-3 border border-gray-300 rounded-lg focus:border-nauss-green focus:outline-none">
         </div>
         <div><label class="block text-sm font-semibold text-gray-700 mb-2">ููุน ุงููุนุงููุฉ</label> <select id="archiveTypeFilter" class="w-full p-3 border border-gray-300 rounded-lg focus:border-nauss-green focus:outline-none"> <option value="">ุฌููุน ุงูุฃููุงุน</option> <option value="internal">ุฏุงุฎููุฉ</option> <option value="external">ุฎุงุฑุฌูุฉ</option> </select>
         </div>
         <div><label class="block text-sm font-semibold text-gray-700 mb-2">ูู ุชุงุฑูุฎ</label> <input type="date" id="archiveDateFrom" class="w-full p-3 border border-gray-300 rounded-lg focus:border-nauss-green focus:outline-none">
         </div>
         <div><label class="block text-sm font-semibold text-gray-700 mb-2">ุฅูู ุชุงุฑูุฎ</label> <input type="date" id="archiveDateTo" class="w-full p-3 border border-gray-300 rounded-lg focus:border-nauss-green focus:outline-none">
         </div>
        </div>
        <div class="flex gap-3 mt-4"><button onclick="filterArchive()" class="bg-nauss-green hover:bg-nauss-dark text-white px-4 py-2 rounded-lg transition-colors"> ุชุทุจูู ุงูููุชุฑ </button> <button onclick="clearArchiveFilters()" class="bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-lg transition-colors"> ูุณุญ ุงูููุงุชุฑ </button>
        </div>
       </div>
       <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
        <div class="bg-gradient-to-r from-blue-500 to-blue-600 text-white p-4 rounded-lg">
         <div class="flex items-center justify-between">
          <div>
           <p class="text-blue-100">ุฅุฌูุงูู ุงููุนุงููุงุช</p>
           <p class="text-2xl font-bold" id="totalTransactions">0</p>
          </div>
          <svg class="w-8 h-8 text-blue-200" fill="currentColor" viewbox="0 0 24 24"><path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8l-6-6z" />
          </svg>
         </div>
        </div>
        <div class="bg-gradient-to-r from-green-500 to-green-600 text-white p-4 rounded-lg">
         <div class="flex items-center justify-between">
          <div>
           <p class="text-green-100">ูุฐุง ุงูุดูุฑ</p>
           <p class="text-2xl font-bold" id="monthlyTransactions">0</p>
          </div>
          <svg class="w-8 h-8 text-green-200" fill="currentColor" viewbox="0 0 24 24"><path d="M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z" />
          </svg>
         </div>
        </div>
        <div class="bg-gradient-to-r from-purple-500 to-purple-600 text-white p-4 rounded-lg">
         <div class="flex items-center justify-between">
          <div>
           <p class="text-purple-100">ุฏุงุฎููุฉ</p>
           <p class="text-2xl font-bold" id="internalTransactions">0</p>
          </div>
          <svg class="w-8 h-8 text-purple-200" fill="currentColor" viewbox="0 0 24 24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z" />
          </svg>
         </div>
        </div>
        <div class="bg-gradient-to-r from-orange-500 to-orange-600 text-white p-4 rounded-lg">
         <div class="flex items-center justify-between">
          <div>
           <p class="text-orange-100">ุฎุงุฑุฌูุฉ</p>
           <p class="text-2xl font-bold" id="externalTransactions">0</p>
          </div>
          <svg class="w-8 h-8 text-orange-200" fill="currentColor" viewbox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z" />
          </svg>
         </div>
        </div>
       </div>
       <div id="archiveList" class="space-y-4">
        <div class="text-center text-gray-500 py-8">
         <svg class="w-16 h-16 mx-auto mb-4 text-gray-300" fill="currentColor" viewbox="0 0 24 24"><path d="M3 4h18v2H3V4zm0 7h18v9a2 2 0 01-2 2H5a2 2 0 01-2-2v-9zm2 2v7h14v-7H5zm2 2h10v1H7v-1zm0 2h7v1H7v-1z" />
         </svg>
         <p class="text-lg">ูุง ุชูุฌุฏ ูุนุงููุงุช ูุญููุธุฉ</p>
         <p class="text-sm">ุงุจุฏุฃ ุจุฅูุดุงุก ูุนุงููุฉ ุฌุฏูุฏุฉ ูุชุธูุฑ ููุง</p>
        </div>
       </div>
      </div>
     </div>
    </div><!-- Generated Letter Output -->
    <div id="letterOutput" class="hidden">
     <div class="bg-white rounded-lg shadow-lg p-6">
      <div class="flex items-center justify-between mb-6">
       <h3 class="text-xl font-bold text-nauss-green">ุงููุฑุงุณูุฉ ุงูููููุฏุฉ</h3>
       <div class="flex gap-3"><button onclick="saveToArchive()" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors flex items-center">
         <svg class="w-4 h-4 ml-2" fill="currentColor" viewbox="0 0 24 24"><path d="M3 4h18v2H3V4zm0 7h18v9a2 2 0 01-2 2H5a2 2 0 01-2-2v-9zm2 2v7h14v-7H5zm2 2h10v1H7v-1zm0 2h7v1H7v-1z" />
         </svg> ุญูุธ ูู ุงูุฃุฑุดูู </button> <button onclick="toggleEditMode()" id="editToggle" class="bg-nauss-gold hover:bg-yellow-600 text-white px-4 py-2 rounded-lg transition-colors"> ุชุนุฏูู </button>
       </div>
      </div>
      <div id="letterDisplay" class="bg-nauss-light p-6 rounded-lg mb-6 border-r-4 border-nauss-green"></div>
      <div id="letterEditor" class="hidden mb-6"><textarea id="letterTextEditor" class="w-full p-4 border border-gray-300 rounded-lg focus:border-nauss-green focus:outline-none resize-none" style="direction: rtl; height: 400px;"></textarea>
       <div class="flex gap-3 mt-4"><button onclick="saveEdits()" class="bg-nauss-green hover:bg-nauss-dark text-white px-4 py-2 rounded-lg transition-colors"> ุญูุธ ุงูุชุบููุฑุงุช </button> <button onclick="cancelEdits()" class="bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-lg transition-colors"> ุฅูุบุงุก </button>
       </div>
      </div>
      <div class="flex flex-wrap gap-3"><button onclick="copyLetter()" class="bg-nauss-green hover:bg-nauss-dark text-white px-4 py-2 rounded-lg transition-colors"> ๐ ูุณุฎ ุงููุฑุงุณูุฉ </button> <button onclick="exportToWord()" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors"> ๐ ุชุตุฏูุฑ Word </button> <button onclick="createNewLetter()" class="bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg transition-colors"> โ ุฅูุดุงุก ูุฑุงุณูุฉ ุฌุฏูุฏุฉ </button>
      </div>
     </div>
    </div>
   </div>
  </main>
  <script>
        // Global variables
        let currentCategory = '';
        let currentLetterType = '';
        let currentLetterContent = '';
        let archiveData = JSON.parse(localStorage.getItem('archiveData')) || [];
        
        // Letter templates (shortened for brevity - you have the full version)
        const letterTemplates = {
            internal: {
                'course_opening_report': {
                    title: 'ุชูุฑูุฑ ุงูุชุชุงุญ ุฏูุฑุฉ ุชุฏุฑูุจูุฉ',
                    fields: [
                        { id: 'courseTitle', label: 'ุงุณู ุงูุฏูุฑุฉ ุงูุชุฏุฑูุจูุฉ', type: 'text', required: true },
                        { id: 'city', label: 'ููุงู ุงูุงูุนูุงุฏ (ุงููุฏููุฉ)', type: 'text', placeholder: 'ูุซุงู: ุงูุฑูุงุถุ ุฌุฏุฉุ ุงููุฏููุฉ ุงููููุฑุฉ', required: true },
                        { id: 'startDate', label: 'ุชุงุฑูุฎ ุจุฏุงูุฉ ุงูุชูููุฐ', type: 'date', required: true },
                        { id: 'endDate', label: 'ุชุงุฑูุฎ ููุงูุฉ ุงูุชูููุฐ', type: 'date', required: true },
                        { id: 'supervisorName', label: 'ุงุณู ุงููุดุฑู ุงูููุฏุงูู', type: 'text', required: true },
                        { id: 'participantCount', label: 'ุนุฏุฏ ุงููุดุงุฑููู ุงููุณุฌููู', type: 'number', required: true },
                        { id: 'actualAttendance', label: 'ุนุฏุฏ ุงูุญุถูุฑ ุงููุนูู', type: 'number', required: true },
                        { id: 'trainerCount', label: 'ุนุฏุฏ ุงููุฏุฑุจูู', type: 'number', required: true },
                        { id: 'trainingEnvironment', label: 'ุงูุจูุฆุฉ ุงูุชุฏุฑูุจูุฉ', type: 'textarea', placeholder: '๐ก ุฃูุซูุฉ ููููุฉ:\nโข ุงููุงุนุฉ ูุงุณุนุฉ ููุฑูุญุฉ ูุน ุฅุถุงุกุฉ ุทุจูุนูุฉ ููุชุงุฒุฉ ูุชูููุฉ ุฌูุฏุฉ\nโข ุงูููุงุนุฏ ูุฑูุญุฉ ููุฑุชุจุฉ ุจุดูู ูุณูู ุงูุชูุงุนู ุจูู ุงููุชุฏุฑุจูู\nโข ุงูุตูุชูุงุช ูุงุถุญุฉ ูุงูุดุงุดุงุช ูุจูุฑุฉ ููุฑุฆูุฉ ูู ุฌููุน ุงูุฒูุงูุง\nโข ุงูููุงู ูุงุฏุฆ ูุจุนูุฏ ุนู ุงูุถูุถุงุก ููุง ูุณุงุนุฏ ุนูู ุงูุชุฑููุฒ\nโข ุชููุฑ ูุณุงุญุงุช ุงุณุชุฑุงุญุฉ ููุงุณุจุฉ ูุฎุฏูุงุช ูุณุงูุฏุฉ', required: true },
                        { id: 'trainingVenueRating', label: 'ุชูููู ููุฑ ุงูุชุฏุฑูุจ', type: 'select', options: ['ููุชุงุฒ', 'ุฌูุฏ ุฌุฏุงู', 'ุฌูุฏ', 'ููุจูู', 'ูุญุชุงุฌ ุชุญุณูู'], required: true },
                        { id: 'logisticsPreparation', label: 'ุงูุชุฌููุฒุงุช ุงูููุฌุณุชูุฉ', type: 'textarea', placeholder: '๐ก ุฃูุซูุฉ ููููุฉ ููุชุฌููุฒุงุช:\nโข ุงูููุงุฏ ุงูุชุฏุฑูุจูุฉ: ุญูุงุฆุจ ุชุฏุฑูุจูุฉ ุดุงููุฉุ ุฃุฏูุฉ ูุทุจูุนุฉ ุจุฌูุฏุฉ ุนุงููุฉุ ูุณุฎ ุฅููุชุฑูููุฉ\nโข ุงูุฃุฌูุฒุฉ ุงูุชูููุฉ: ุฃุฌูุฒุฉ ุนุฑุถ ุญุฏูุซุฉุ ูุงุจุชูุจุงุชุ ุฃุฌูุฒุฉ ุตูุชุ ูููุฑููููุงุช ูุงุณูููุฉ\nโข ุงูุฅูุชุฑูุช: ุดุจูุฉ ูุงู ูุงู ุนุงููุฉ ุงูุณุฑุนุฉ ููุณุชูุฑุฉ\nโข ุงููุฑุทุงุณูุฉ: ุฃููุงูุ ุฏูุงุชุฑุ ูููุงุชุ ุฃูุฑุงู ููุงุญุธุงุช\nโข ุงูุถูุงูุฉ: ูููุฉุ ุดุงูุ ููุงูุ ูุฌุจุงุช ุฎูููุฉุ ุงุณุชุฑุงุญุงุช ููุธูุฉ\nโข ุงูููุงุตูุงุช: ุญุงููุงุช ููููุฉุ ููุงุนูุฏ ููุชุธูุฉุ ุณุงุฆููู ูุญุชุฑููู\nโข ุฃุฏูุงุช ุงูุนุฑุถ: ุณุจูุฑุฉ ุฐููุฉุ ุฃููุงู ููููุฉุ ููุญุงุช ุนุฑุถ', required: true },
                        { id: 'interpreterCount', label: 'ุนุฏุฏ ุงููุชุฑุฌููู (ุฅู ูุฌุฏ)', type: 'number', required: false },
                        { id: 'positives', label: 'ุงูุฅูุฌุงุจูุงุช', type: 'textarea', placeholder: '๐ก ุฃูุซูุฉ ููููุฉ ููุฅูุฌุงุจูุงุช:\nโข ุงูุชุฒุงู ุงููุดุงุฑููู ุจุงูุญุถูุฑ ูู ุงูููุช ุงููุญุฏุฏ ูุญูุงุณูู ุงููุงุถุญ\nโข ุชูุงุนู ุฅูุฌุงุจู ูู ุงููุชุฏุฑุจูู ูุน ุงููุฏุฑุจ ููุฐ ุงูุฌูุณุฉ ุงูุฃููู\nโข ุฌูุฏุฉ ุงููุญุชูู ุงูุชุฏุฑูุจู ูุชูุธูู ุงููุงุฏุฉ ุงูุนูููุฉ ุจุดูู ุงุญุชุฑุงูู\nโข ููุงุกุฉ ุงููุฏุฑุจูู ูุฎุจุฑุชูู ุงูุนูููุฉ ูู ุงููุฌุงู\nโข ุงูุชูุณูู ุงูููุชุงุฒ ูุน ุงูุฌูุฉ ุงูููุธูุฉ ูุงูุงุณุชุฌุงุจุฉ ุงูุณุฑูุนุฉ\nโข ุชููุฑ ุฌููุน ุงููุชุทูุจุงุช ุงูุชูููุฉ ูุงูููุฌุณุชูุฉ ูุจู ุงูููุนุฏ\nโข ุงูุชุฑุญูุจ ุงูุญุงุฑ ูุงูุชูุธูู ุงูุฅุฏุงุฑู ุงููุชููุฒ', required: true },
                        { id: 'negatives', label: 'ุงูุณูุจูุงุช', type: 'textarea', placeholder: '๐ก ุฃูุซูุฉ ููููุฉ ููุณูุจูุงุช (ุงุฐูุฑ ููุท ูุง ููุทุจู):\nโข ุชุฃุฎุฑ ุจุนุถ ุงููุดุงุฑููู ูู ุงูููู ุงูุฃูู ุจุณุจุจ ุนุฏู ูุถูุญ ูููุน ุงููุงุนุฉ\nโข ุถุนู ุงูุฅูุชุฑูุช ูู ุจุนุถ ุงูุฃููุงุช ููุง ุฃุซุฑ ุนูู ุงูุนุฑูุถ ุงูุชูุงุนููุฉ\nโข ุนุฏู ููุงูุฉ ุฃูุงูู ุงูุงุณุชุฑุงุญุฉ ูุนุฏุฏ ุงููุดุงุฑููู\nโข ููุต ูู ุจุนุถ ุงูููุงุฏ ุงูุชุฏุฑูุจูุฉ ุงููุทุจูุนุฉ\nโข ุตุนูุจุฉ ุงููุตูู ูููููุน ุจุณุจุจ ุงูุงุฒุฏุญุงู ุงููุฑูุฑู\nโข ุนุฏู ุชููุฑ ููุงูู ูุงููุฉ ููุณูุงุฑุงุช\nโข ุงุฑุชูุงุน ุฏุฑุฌุฉ ุงูุญุฑุงุฑุฉ ูู ุงููุงุนุฉ ูู ูุชุฑุฉ ูุง ุจุนุฏ ุงูุธูุฑ', required: false },
                        { id: 'recommendations', label: 'ุงูุชูุตูุงุช', type: 'textarea', placeholder: '๐ก ุฃูุซูุฉ ููููุฉ ููุชูุตูุงุช:\nโข ุฅุฑุณุงู ุฎุฑุงุฆุท ุชูุถูุญูุฉ ูููููุน ูุจู ุจุฏุก ุงูุฏูุฑุฉ ุจููููู\nโข ุงูุชูุณูู ูุน ูุฒูุฏ ุงูุฅูุชุฑูุช ูุชูููุฑ ุฎุท ุงุญุชูุงุทู\nโข ุฒูุงุฏุฉ ุนุฏุฏ ุงูุงุณุชุฑุงุญุงุช ุงููุตูุฑุฉ ููุญูุงุธ ุนูู ุชุฑููุฒ ุงููุชุฏุฑุจูู\nโข ุทุจุงุนุฉ ูุณุฎ ุฅุถุงููุฉ ูู ุงูููุงุฏ ุงูุชุฏุฑูุจูุฉ ูุงุญุชูุงุท\nโข ุชูููุฑ ุฎุฏูุฉ ููู ุฌูุงุนู ูู ููุงุท ุชุฌูุน ูุญุฏุฏุฉ\nโข ุงูุชุฃูุฏ ูู ุตูุงูุฉ ุฃุฌูุฒุฉ ุงูุชูููู ูุจู ุจุฏุก ุงูุฏูุฑุงุช\nโข ุฅุนุฏุงุฏ ุงุณุชุจูุงู ูููู ุณุฑูุน ูููุงุณ ุฑุถุง ุงููุชุฏุฑุจูู', required: false }
                    ]
                },
                'course_closing_report': {
                    title: 'ุชูุฑูุฑ ุงุฎุชุชุงู ุฏูุฑุฉ ุชุฏุฑูุจูุฉ',
                    fields: [
                        { id: 'courseTitle', label: 'ุงุณู ุงูุฏูุฑุฉ ุงูุชุฏุฑูุจูุฉ', type: 'text', required: true },
                        { id: 'city', label: 'ููุงู ุงูุงูุนูุงุฏ (ุงููุฏููุฉ)', type: 'text', placeholder: 'ูุซุงู: ุงูุฑูุงุถุ ุฌุฏุฉุ ุงููุฏููุฉ ุงููููุฑุฉ', required: true },
                        { id: 'startDate', label: 'ุชุงุฑูุฎ ุจุฏุงูุฉ ุงูุชูููุฐ', type: 'date', required: true },
                        { id: 'endDate', label: 'ุชุงุฑูุฎ ููุงูุฉ ุงูุชูููุฐ', type: 'date', required: true },
                        { id: 'supervisorName', label: 'ุงุณู ุงููุดุฑู ุงูููุฏุงูู', type: 'text', required: true },
                        { id: 'participantCount', label: 'ุนุฏุฏ ุงููุดุงุฑููู ุงููุณุฌููู', type: 'number', required: true },
                        { id: 'completedCount', label: 'ุนุฏุฏ ุงููุชุฏุฑุจูู ุงูุฐูู ุฃููููุง ุงูุฏูุฑุฉ', type: 'number', required: true },
                        { id: 'trainerCount', label: 'ุนุฏุฏ ุงููุฏุฑุจูู', type: 'number', required: true },
                        { id: 'overallRating', label: 'ุงูุชูููู ุงูุนุงู ููุฏูุฑุฉ', type: 'select', options: ['ููุชุงุฒ', 'ุฌูุฏ ุฌุฏุงู', 'ุฌูุฏ', 'ููุจูู', 'ูุญุชุงุฌ ุชุญุณูู'], required: true },
                        { id: 'participantSatisfaction', label: 'ูุณุจุฉ ุฑุถุง ุงููุชุฏุฑุจูู', type: 'number', placeholder: 'ุฃุฏุฎู ุงููุณุจุฉ ูู 0 ุฅูู 100', required: true },
                        { id: 'objectivesAchievement', label: 'ูุฏู ุชุญููู ุงูุฃูุฏุงู ุงูุชุฏุฑูุจูุฉ', type: 'textarea', placeholder: '๐ก ุฃูุซูุฉ ููููุฉ:\nโข ุชู ุชุญููู ุฌููุน ุงูุฃูุฏุงู ุงููุญุฏุฏุฉ ูู ุงูุฎุทุฉ ุงูุชุฏุฑูุจูุฉ ุจูุณุจุฉ 100%\nโข ุงูุชุณุจ ุงููุชุฏุฑุจูู ุงูููุงุฑุงุช ุงูุนูููุฉ ุงููุณุชูุฏูุฉ ูุทุจูููุง ูู ุงูุชูุงุฑูู\nโข ุฃุธูุฑ ุงููุชุฏุฑุจูู ูููุงู ุนูููุงู ููููุงููู ุงููุธุฑูุฉ ูุงูุชุทุจูููุฉ\nโข ูุฌุญ 95% ูู ุงููุชุฏุฑุจูู ูู ุงูุงุฎุชุจุงุฑุงุช ุงูููุงุฆูุฉ ุจุฏุฑุฌุงุช ููุชุงุฒุฉ\nโข ุชููู ุงููุชุฏุฑุจูู ูู ุญู ุฏุฑุงุณุงุช ุงูุญุงูุฉ ุงููุนูุฏุฉ ุจููุงุกุฉ ุนุงููุฉ', required: true },
                        { id: 'strengths', label: 'ููุงุท ุงูููุฉ', type: 'textarea', placeholder: '๐ก ุฃูุซูุฉ ููููุฉ ูููุงุท ุงูููุฉ:\nโข ุงูุชุฒุงู ุงููุชุฏุฑุจูู ุจุงูุญุถูุฑ ุทูุงู ูุชุฑุฉ ุงูุฏูุฑุฉ ุจูุณุจุฉ 98%\nโข ุงูุชูุงุนู ุงูุฅูุฌุงุจู ูุงููุดุงุฑูุฉ ุงููุนุงูุฉ ูู ุฌููุน ุงูุฃูุดุทุฉ ุงูุชุฏุฑูุจูุฉ\nโข ุฌูุฏุฉ ุงููุญุชูู ุงูุชุฏุฑูุจู ูููุงุกูุชู ูุงุญุชูุงุฌุงุช ุงููุชุฏุฑุจูู\nโข ููุงุกุฉ ุงููุฏุฑุจูู ููุฏุฑุชูู ุนูู ุฅูุตุงู ุงููุนูููุฉ ุจุฃุณุงููุจ ูุชููุนุฉ\nโข ุงูุชูุธูู ุงูุฅุฏุงุฑู ุงูููุชุงุฒ ูุงูุงูุชุฒุงู ุจุงูุฌุฏูู ุงูุฒููู\nโข ุชููุฑ ุฌููุน ุงูููุงุฑุฏ ูุงูุชุฌููุฒุงุช ุงููุงุฒูุฉ ุทูุงู ูุชุฑุฉ ุงูุชุฏุฑูุจ\nโข ุงูุชูููู ุงููุณุชูุฑ ูุงูุชุบุฐูุฉ ุงูุฑุงุฌุนุฉ ุงูููุฑูุฉ ูููุชุฏุฑุจูู', required: true },
                        { id: 'weaknesses', label: 'ููุงุท ุงูุถุนู', type: 'textarea', placeholder: '๐ก ุฃูุซูุฉ ููููุฉ ูููุงุท ุงูุถุนู (ุงุฐูุฑ ููุท ูุง ููุทุจู):\nโข ูุตุฑ ุงูููุช ุงููุฎุตุต ูุจุนุถ ุงูููุถูุนุงุช ุงููููุฉ\nโข ุนุฏู ููุงูุฉ ุงูุชุทุจููุงุช ุงูุนูููุฉ ูู ุจุนุถ ุงููุญุฏุงุช ุงูุชุฏุฑูุจูุฉ\nโข ุชูุงูุช ูุณุชููุงุช ุงููุชุฏุฑุจูู ููุง ุฃุซุฑ ุนูู ุณุฑุนุฉ ุงูุชูุฏู\nโข ููุต ูู ุจุนุถ ุงูุฃูุซูุฉ ุงููุงูุนูุฉ ูู ุงูุจูุฆุฉ ุงููุญููุฉ\nโข ูุญุฏูุฏูุฉ ุงูููุช ุงููุฎุตุต ููุฃุณุฆูุฉ ูุงูููุงุดุงุช\nโข ุนุฏู ุชููุฑ ุจุนุถ ุงููุฑุงุฌุน ุงูุฅุถุงููุฉ ุงููุทููุจุฉ\nโข ุตุนูุจุฉ ุจุนุถ ุงูุชูุงุฑูู ุจุงููุณุจุฉ ูููุจุชุฏุฆูู', required: false },
                        { id: 'recommendations', label: 'ุงูุชูุตูุงุช', type: 'textarea', placeholder: '๐ก ุฃูุซูุฉ ููููุฉ ููุชูุตูุงุช:\nโข ุฒูุงุฏุฉ ูุฏุฉ ุงูุฏูุฑุฉ ุจููููู ุฅุถุงูููู ูุชุบุทูุฉ ุงููุญุชูู ุจุดูู ุฃุนูู\nโข ุชูุณูู ุงููุชุฏุฑุจูู ุฅูู ูุฌููุนุงุช ุญุณุจ ุงููุณุชูู ูู ุงูุฏูุฑุงุช ุงููุงุฏูุฉ\nโข ุฅุถุงูุฉ ุงููุฒูุฏ ูู ุฏุฑุงุณุงุช ุงูุญุงูุฉ ุงููุญููุฉ ูุงูุฃูุซูุฉ ุงููุงูุนูุฉ\nโข ุชูููุฑ ููุงุฏ ุชุฏุฑูุจูุฉ ุฅุถุงููุฉ ููุฑุงุฌุน ุฅููุชุฑูููุฉ ูููุชุฏุฑุจูู\nโข ุชุฎุตูุต ุฌูุณุงุช ูุชุงุจุนุฉ ุจุนุฏ ุดูุฑ ูููุงุณ ุฃุซุฑ ุงูุชุฏุฑูุจ\nโข ุฅูุดุงุก ูุฌููุนุฉ ุชูุงุตู ูููุชุฏุฑุจูู ูุชุจุงุฏู ุงูุฎุจุฑุงุช\nโข ุชุทููุฑ ุฏูุฑุงุช ูุชูุฏูุฉ ูููุชุฏุฑุจูู ุงููุชููุฒูู', required: false },
                        { id: 'certificates', label: 'ุงูุดูุงุฏุงุช ูุงูุชูุฑูู', type: 'textarea', placeholder: '๐ก ุฃูุซูุฉ ููููุฉ:\nโข ุชู ุชูุฒูุน ุงูุดูุงุฏุงุช ุนูู ุฌููุน ุงููุชุฏุฑุจูู ุงูุฐูู ุฃููููุง ุงูุฏูุฑุฉ ุจูุฌุงุญ\nโข ุชูุฑูู ุงููุชุฏุฑุจูู ุงููุชููุฒูู ุงูุซูุงุซุฉ ุงูุฃูุงุฆู ุจุดูุงุฏุงุช ุชูุฏูุฑ ุฎุงุตุฉ\nโข ุชุณููู ุญูุงุฆุจ ุชุฐูุงุฑูุฉ ุชุญุชูู ุนูู ููุงุฏ ูุฑุฌุนูุฉ ููุทุจูุนุงุช\nโข ุชูุซูู ุงูุญูู ุงูุฎุชุงูู ุจุงูุตูุฑ ูุงูููุฏูู\nโข ุญุถูุฑ ูุณุคูููู ูู ุงูุฌูุฉ ุงููุณุชููุฏุฉ ูุญูู ุงูุชุฎุฑุฌ', required: true }
                    ]
                }
            },
            external: {
                'security_participants_notification': {
                    title: 'ุชุจููุบ ุฅุฏุงุฑุฉ ุงูุฃูู ุจุฃุณูุงุก ุงููุดุงุฑููู',
                    fields: [
                        { id: 'coursesTable', label: 'ุฌุฏูู ุงูุฏูุฑุงุช (ุณูุชู ุฅูุดุงุคู ุชููุงุฆูุงู)', type: 'hidden' }
                    ],
                    hasDynamicTable: true,
                    hasImportFeature: true
                },
                'hospitality_notification': {
                    title: 'ุชุจููุบ ุงููุฑุงุณู ูุงูุถูุงูุฉ ุจุชูููุฐ ุงูุฏูุฑุงุช ุงูุชุฏุฑูุจูุฉ',
                    fields: [
                        { id: 'coursesTable', label: 'ุฌุฏูู ุงูุฏูุฑุงุช (ุณูุชู ุฅูุดุงุคู ุชููุงุฆูุงู)', type: 'hidden' }
                    ],
                    hasDynamicTable: true,
                    hasImportFeature: true,
                    hasHospitalityRequests: true
                },
                'support_services_notification': {
                    title: 'ุชุจููุบ ุฅุฏุงุฑุฉ ุงูุฎุฏูุงุช ุงููุณุงูุฏุฉ ุจุงูุฏูุฑุงุช ุงูุชุฏุฑูุจูุฉ',
                    fields: [
                        { id: 'coursesTable', label: 'ุฌุฏูู ุงูุฏูุฑุงุช (ุณูุชู ุฅูุดุงุคู ุชููุงุฆูุงู)', type: 'hidden' }
                    ],
                    hasDynamicTable: true,
                    hasImportFeature: true,
                    hasSupportRequests: true
                },
                'medical_clinic_notification': {
                    title: 'ุชุจููุบ ุงูุนูุงุฏุฉ ุงูุทุจูุฉ ุจุงูุฏูุฑุงุช ุงูุชุฏุฑูุจูุฉ ุงููููุฐุฉ',
                    fields: [
                        { id: 'coursesTable', label: 'ุฌุฏูู ุงูุฏูุฑุงุช (ุณูุชู ุฅูุดุงุคู ุชููุงุฆูุงู)', type: 'hidden' }
                    ],
                    hasDynamicTable: true,
                    hasImportFeature: true,
                    hasMedicalRequests: true
                }
            }
        };

        function selectCategory(category) {
            currentCategory = category;
            document.getElementById('categorySelection').classList.add('hidden');
            document.getElementById('letterTypeSection').classList.remove('hidden');
            
            const letterTypeSelect = document.getElementById('letterType');
            letterTypeSelect.innerHTML = '<option value="">-- ุงุฎุชุฑ ููุน ุงููุฑุงุณูุฉ --</option>';
            
            const templates = letterTemplates[category];
            for (const [key, value] of Object.entries(templates)) {
                const option = document.createElement('option');
                option.value = key;
                option.textContent = value.title;
                letterTypeSelect.appendChild(option);
            }
        }
        
        function handleLetterTypeChange() {
            const letterTypeSelect = document.getElementById('letterType');
            if (letterTypeSelect.value) {
                currentLetterType = letterTypeSelect.value;
                showFormFields();
            } else {
                document.getElementById('formFields').classList.add('hidden');
            }
        }

        function showFormFields() {
            const template = letterTemplates[currentCategory][currentLetterType];
            const formFields = document.getElementById('formFields');
            const dynamicFields = document.getElementById('dynamicFields');
            
            dynamicFields.innerHTML = '';
            
            template.fields.forEach(field => {
                if (field.type === 'hidden') return;
                
                const fieldDiv = document.createElement('div');
                fieldDiv.className = 'col-span-1';
                
                const label = document.createElement('label');
                label.className = 'block text-sm font-semibold text-gray-700 mb-2';
                label.textContent = field.label;
                
                let input;
                if (field.type === 'textarea') {
                    input = document.createElement('textarea');
                    input.rows = 4;
                } else if (field.type === 'select') {
                    input = document.createElement('select');
                    const defaultOption = document.createElement('option');
                    defaultOption.value = '';
                    defaultOption.textContent = '-- ุงุฎุชุฑ --';
                    input.appendChild(defaultOption);
                    
                    if (field.options) {
                        field.options.forEach(opt => {
                            const option = document.createElement('option');
                            option.value = opt;
                            option.textContent = opt;
                            input.appendChild(option);
                        });
                    }
                } else {
                    input = document.createElement('input');
                    input.type = field.type;
                }
                
                input.id = field.id;
                input.className = 'w-full p-3 border border-gray-300 rounded-lg focus:border-nauss-green focus:outline-none';
                
                // Add placeholder if exists
                if (field.placeholder) {
                    input.placeholder = field.placeholder;
                }
                
                fieldDiv.appendChild(label);
                
                // Add example hint for fields with placeholders
                if (field.placeholder && field.placeholder.includes('๐ก')) {
                    const hintContainer = document.createElement('div');
                    hintContainer.className = 'relative mb-2';
                    
                    const iconButton = document.createElement('button');
                    iconButton.type = 'button';
                    iconButton.className = 'text-yellow-500 hover:text-yellow-600 transition-colors cursor-pointer text-2xl';
                    iconButton.innerHTML = '๐ก';
                    iconButton.title = 'ุงุถุบุท ูุนุฑุถ ุงูุฃูุซูุฉ ุงูููููุฉ';
                    
                    const hintDiv = document.createElement('div');
                    hintDiv.className = 'hidden absolute z-50 bg-blue-50 border-2 border-blue-400 p-4 rounded-lg shadow-2xl text-sm mt-2 w-full max-w-2xl';
                    hintDiv.style.maxHeight = '400px';
                    hintDiv.style.overflowY = 'auto';
                    hintDiv.innerHTML = `
                        <div class="flex items-start">
                            <span class="text-blue-500 text-lg ml-2">๐ก</span>
                            <div class="text-blue-800 flex-1" style="white-space: pre-line; line-height: 1.6;">${field.placeholder.replace('๐ก ุฃูุซูุฉ ููููุฉ:', '<strong>ุฃูุซูุฉ ููููุฉ:</strong>').replace(/\n/g, '<br>')}</div>
                            <button type="button" onclick="this.parentElement.parentElement.classList.add('hidden')" class="text-gray-500 hover:text-gray-700 font-bold text-xl mr-2">ร</button>
                        </div>
                    `;
                    
                    iconButton.addEventListener('click', function(e) {
                        e.preventDefault();
                        hintDiv.classList.toggle('hidden');
                    });
                    
                    hintContainer.appendChild(iconButton);
                    hintContainer.appendChild(hintDiv);
                    fieldDiv.appendChild(hintContainer);
                    
                    input.placeholder = 'ุงูุชุจ ููุง...';
                }
                
                fieldDiv.appendChild(input);
                dynamicFields.appendChild(fieldDiv);
            });
            
            // Show hospitality requests section if applicable
            if (template.hasHospitalityRequests) {
                setTimeout(() => {
                    const breakTimesSection = document.getElementById('breakTimesSection');
                    if (breakTimesSection) {
                        breakTimesSection.classList.remove('hidden');
                    }
                    
                    const hospitalitySection = document.getElementById('hospitalityRequestsSection');
                    if (hospitalitySection) {
                        hospitalitySection.classList.remove('hidden');
                        
                        // Add event listeners for checkboxes
                        document.getElementById('receptionHall')?.addEventListener('change', function() {
                            document.getElementById('receptionHallItems').classList.toggle('hidden', !this.checked);
                        });
                        
                        document.getElementById('coffeeMachines')?.addEventListener('change', function() {
                            document.getElementById('coffeeMachinesDetails').classList.toggle('hidden', !this.checked);
                        });
                        
                        document.getElementById('vipLounge')?.addEventListener('change', function() {
                            document.getElementById('vipLoungeDetails').classList.toggle('hidden', !this.checked);
                        });
                        
                        document.getElementById('vipLunch')?.addEventListener('change', function() {
                            document.getElementById('vipLunchCount').classList.toggle('hidden', !this.checked);
                        });
                        
                        document.getElementById('externalHospitality')?.addEventListener('change', function() {
                            document.getElementById('externalHospitalityDetails').classList.toggle('hidden', !this.checked);
                        });
                        
                        document.getElementById('otherRequests')?.addEventListener('change', function() {
                            document.getElementById('otherRequestsDetails').classList.toggle('hidden', !this.checked);
                        });
                    }
                }, 100);
            }
            
            // Show support services requests section if applicable
            if (template.hasSupportRequests) {
                setTimeout(() => {
                    const supportSection = document.getElementById('supportServicesSection');
                    if (supportSection) {
                        supportSection.classList.remove('hidden');
                        
                        // Add event listeners for checkboxes
                        document.getElementById('otherSupportRequests')?.addEventListener('change', function() {
                            document.getElementById('otherSupportRequestsDetails').classList.toggle('hidden', !this.checked);
                        });
                    }
                }, 100);
            }
            
            // Show medical requests section if applicable
            if (template.hasMedicalRequests) {
                setTimeout(() => {
                    const medicalSection = document.getElementById('medicalRequestsSection');
                    if (medicalSection) {
                        medicalSection.classList.remove('hidden');
                        
                        // Add event listeners for checkboxes
                        document.getElementById('otherMedicalRequests')?.addEventListener('change', function() {
                            document.getElementById('otherMedicalRequestsDetails').classList.toggle('hidden', !this.checked);
                        });
                    }
                }, 100);
            }
            
            // Add dynamic table builder for security notification
            if (template.hasDynamicTable) {
                const tableSection = document.createElement('div');
                tableSection.className = 'col-span-2 mt-6 bg-gray-50 p-6 rounded-lg border-2 border-nauss-green';
                tableSection.innerHTML = `
                    <h4 class="text-lg font-bold text-nauss-green mb-4">๐ ุฌุฏูู ุงูุฏูุฑุงุช ุงูุชุฏุฑูุจูุฉ</h4>
                    
                    <!-- Input Method Selection -->
                    <div class="mb-6 flex gap-3">
                        <button type="button" onclick="showManualInput()" id="manualInputBtn" class="flex-1 bg-nauss-green text-white px-4 py-3 rounded-lg font-bold transition-colors hover:bg-nauss-dark">
                            โ๏ธ ุฅุฏุฎุงู ูุฏูู
                        </button>
                        <button type="button" onclick="showImportInput()" id="importInputBtn" class="flex-1 bg-gray-300 text-gray-700 px-4 py-3 rounded-lg font-bold transition-colors hover:bg-gray-400">
                            ๐ฅ ุงุณุชูุฑุงุฏ ูู Excel
                        </button>
                    </div>
                    
                    <!-- Manual Input Section -->
                    <div id="manualInputSection">
                        <div id="coursesTableBuilder"></div>
                        <button type="button" onclick="addCourseRow()" class="mt-4 bg-nauss-green hover:bg-nauss-dark text-white px-4 py-2 rounded-lg transition-colors">
                            โ ุฅุถุงูุฉ ุฏูุฑุฉ
                        </button>
                    </div>
                    
                    <!-- Import Section -->
                    <div id="importInputSection" class="hidden">
                        <div class="bg-blue-50 p-4 rounded-lg border border-blue-300">
                            <h5 class="font-bold text-blue-700 mb-2">๐ฅ ุงุณุชูุฑุงุฏ ุงูุจูุงูุงุช ูู Excel</h5>
                            <p class="text-sm text-blue-600 mb-3">ุงูุณุฎ ุงูุจูุงูุงุช ูู Excel ูุงูุตููุง ููุง (6 ุฃุนูุฏุฉ: ุนููุงู ุงูุฏูุฑุฉุ ููุน ุงููุชุฑุฉุ ุนุฏุฏ ุงููุดุงุฑูููุ ูุฏุฉ ุงูุจุฑูุงูุฌุ ุงูุชุงุฑูุฎุ ุงููููุน)</p>
                            <textarea id="importDataTextarea" class="w-full p-3 border border-blue-300 rounded-lg focus:border-blue-500 focus:outline-none resize-none" rows="5" placeholder="ุงูุตู ุงูุจูุงูุงุช ููุง...&#10;ูุซุงู:&#10;Basic Shooting on Firearm	ุตุจุงุญูุฉ	20	2 ููู	16 โ 17 / 11 / 2025ู	ูุฏููุฉ ุชุฏุฑูุจ ุงูุฃูู ุงูุนุงู"></textarea>
                            <button type="button" onclick="importCoursesData()" class="mt-2 bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors">
                                ๐ฅ ุงุณุชูุฑุงุฏ ุงูุจูุงูุงุช
                            </button>
                        </div>
                    </div>
                    

                    
                    <!-- Break Times Configuration Section -->
                    <div id="breakTimesSection" class="hidden mt-6 bg-gradient-to-r from-blue-50 to-cyan-50 p-6 rounded-lg border-2 border-blue-300">
                        <h5 class="font-bold text-blue-700 mb-4 text-lg flex items-center">
                            <span class="text-2xl ml-2">โฐ</span>
                            ุชุฎุตูุต ุฃููุงุช ุงูุฑุงุญุฉ
                        </h5>
                        
                        <!-- Morning Breaks -->
                        <div class="bg-white p-4 rounded-lg border border-blue-200 mb-4">
                            <h6 class="font-semibold text-blue-700 mb-3">ุฃููุงุช ุงูุฑุงุญุฉ ููุฏูุฑุงุช ุงูุตุจุงุญูุฉ</h6>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                                <div>
                                    <label class="block text-sm text-gray-700 mb-1">ุงูุฑุงุญุฉ ุงูุฃููู - ูู</label>
                                    <input type="time" id="morningBreak1Start" value="09:45" class="w-full p-2 border border-gray-300 rounded-lg">
                                </div>
                                <div>
                                    <label class="block text-sm text-gray-700 mb-1">ุงูุฑุงุญุฉ ุงูุฃููู - ุฅูู</label>
                                    <input type="time" id="morningBreak1End" value="10:15" class="w-full p-2 border border-gray-300 rounded-lg">
                                </div>
                                <div>
                                    <label class="block text-sm text-gray-700 mb-1">ุงูุฑุงุญุฉ ุงูุซุงููุฉ - ูู</label>
                                    <input type="time" id="morningBreak2Start" value="11:45" class="w-full p-2 border border-gray-300 rounded-lg">
                                </div>
                                <div>
                                    <label class="block text-sm text-gray-700 mb-1">ุงูุฑุงุญุฉ ุงูุซุงููุฉ - ุฅูู</label>
                                    <input type="time" id="morningBreak2End" value="12:15" class="w-full p-2 border border-gray-300 rounded-lg">
                                </div>
                            </div>
                        </div>
                        
                        <!-- Evening Breaks -->
                        <div class="bg-white p-4 rounded-lg border border-blue-200">
                            <h6 class="font-semibold text-blue-700 mb-3">ุฃููุงุช ุงูุฑุงุญุฉ ููุฏูุฑุงุช ุงููุณุงุฆูุฉ</h6>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                                <div>
                                    <label class="block text-sm text-gray-700 mb-1">ุงูุฑุงุญุฉ ุงูุฃููู - ูู</label>
                                    <input type="time" id="eveningBreak1Start" value="17:00" class="w-full p-2 border border-gray-300 rounded-lg">
                                </div>
                                <div>
                                    <label class="block text-sm text-gray-700 mb-1">ุงูุฑุงุญุฉ ุงูุฃููู - ุฅูู</label>
                                    <input type="time" id="eveningBreak1End" value="17:10" class="w-full p-2 border border-gray-300 rounded-lg">
                                </div>
                                <div>
                                    <label class="block text-sm text-gray-700 mb-1">ุงูุฑุงุญุฉ ุงูุซุงููุฉ - ูู</label>
                                    <input type="time" id="eveningBreak2Start" value="18:10" class="w-full p-2 border border-gray-300 rounded-lg">
                                </div>
                                <div>
                                    <label class="block text-sm text-gray-700 mb-1">ุงูุฑุงุญุฉ ุงูุซุงููุฉ - ุฅูู</label>
                                    <input type="time" id="eveningBreak2End" value="18:25" class="w-full p-2 border border-gray-300 rounded-lg">
                                </div>
                                <div>
                                    <label class="block text-sm text-gray-700 mb-1">ุงูุฑุงุญุฉ ุงูุซุงูุซุฉ - ูู</label>
                                    <input type="time" id="eveningBreak3Start" value="19:15" class="w-full p-2 border border-gray-300 rounded-lg">
                                </div>
                                <div>
                                    <label class="block text-sm text-gray-700 mb-1">ุงูุฑุงุญุฉ ุงูุซุงูุซุฉ - ุฅูู</label>
                                    <input type="time" id="eveningBreak3End" value="19:25" class="w-full p-2 border border-gray-300 rounded-lg">
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Medical Requests Section (for medical clinic notification only) -->
                    <div id="medicalRequestsSection" class="hidden mt-6 bg-gradient-to-r from-blue-50 to-cyan-50 p-6 rounded-lg border-2 border-blue-300">
                        <h5 class="font-bold text-blue-700 mb-4 text-lg flex items-center">
                            <span class="text-2xl ml-2">๐ฅ</span>
                            ุงูุชุฑุชูุจุงุช ุงูุทุจูุฉ ุงููุทููุจุฉ
                        </h5>
                        
                        <div class="space-y-4">
                            <!-- Emergency Readiness -->
                            <div class="bg-white p-4 rounded-lg border border-blue-200">
                                <label class="flex items-center mb-2">
                                    <input type="checkbox" id="emergencyReadiness" class="ml-2 w-4 h-4 text-blue-600" checked>
                                    <span class="font-semibold text-blue-700">ุงูุงุณุชุนุฏุงุฏ ูุฃู ุญุงูุฉ ุตุญูุฉ ุทุงุฑุฆุฉ ุฎูุงู ูุชุฑุฉ ุงูุชูููุฐ</span>
                                </label>
                            </div>
                            
                            <!-- Medical Staff Availability -->
                            <div class="bg-white p-4 rounded-lg border border-blue-200">
                                <label class="flex items-center mb-2">
                                    <input type="checkbox" id="medicalStaffAvailability" class="ml-2 w-4 h-4 text-blue-600" checked>
                                    <span class="font-semibold text-blue-700">ุชูุงุฌุฏ ุทุงูู ุทุจู ูุคูู ุฎูุงู ุณุงุนุงุช ุงูุชุฏุฑูุจ</span>
                                </label>
                            </div>
                            
                            <!-- First Aid Kit -->
                            <div class="bg-white p-4 rounded-lg border border-blue-200">
                                <label class="flex items-center mb-2">
                                    <input type="checkbox" id="firstAidKit" class="ml-2 w-4 h-4 text-blue-600">
                                    <span class="font-semibold text-blue-700">ุชูููุฑ ุญููุจุฉ ุฅุณุนุงูุงุช ุฃูููุฉ ูู ูุงุนุงุช ุงูุชุฏุฑูุจ</span>
                                </label>
                            </div>
                            
                            <!-- Ambulance Standby -->
                            <div class="bg-white p-4 rounded-lg border border-blue-200">
                                <label class="flex items-center mb-2">
                                    <input type="checkbox" id="ambulanceStandby" class="ml-2 w-4 h-4 text-blue-600">
                                    <span class="font-semibold text-blue-700">ุฌุงูุฒูุฉ ุณูุงุฑุฉ ุฅุณุนุงู ูู ุญุงูุงุช ุงูุทูุงุฑุฆ</span>
                                </label>
                            </div>
                            
                            <!-- Medical Examination -->
                            <div class="bg-white p-4 rounded-lg border border-blue-200">
                                <label class="flex items-center mb-2">
                                    <input type="checkbox" id="medicalExamination" class="ml-2 w-4 h-4 text-blue-600">
                                    <span class="font-semibold text-blue-700">ุฅุฌุฑุงุก ูุญุต ุทุจู ูุจุฏุฆู ูููุดุงุฑููู (ุฅู ูุฒู ุงูุฃูุฑ)</span>
                                </label>
                            </div>
                            
                            <!-- Chronic Disease Support -->
                            <div class="bg-white p-4 rounded-lg border border-blue-200">
                                <label class="flex items-center mb-2">
                                    <input type="checkbox" id="chronicDiseaseSupport" class="ml-2 w-4 h-4 text-blue-600">
                                    <span class="font-semibold text-blue-700">ุชูููุฑ ุงูุฏุนู ุงูุทุจู ูุญุงูุงุช ุงูุฃูุฑุงุถ ุงููุฒููุฉ</span>
                                </label>
                            </div>
                            
                            <!-- Emergency Contact Numbers -->
                            <div class="bg-white p-4 rounded-lg border border-blue-200">
                                <label class="flex items-center mb-2">
                                    <input type="checkbox" id="emergencyContacts" class="ml-2 w-4 h-4 text-blue-600">
                                    <span class="font-semibold text-blue-700">ุชูููุฑ ุฃุฑูุงู ุงูุทูุงุฑุฆ ุงูุทุจูุฉ ูููุดุฑููู ุงูููุฏุงูููู</span>
                                </label>
                            </div>
                            
                            <!-- Health Awareness -->
                            <div class="bg-white p-4 rounded-lg border border-blue-200">
                                <label class="flex items-center mb-2">
                                    <input type="checkbox" id="healthAwareness" class="ml-2 w-4 h-4 text-blue-600">
                                    <span class="font-semibold text-blue-700">ุชูุฒูุน ูุดุฑุงุช ุชูุนููุฉ ุตุญูุฉ ุนูู ุงููุดุงุฑููู</span>
                                </label>
                            </div>
                            
                            <!-- Other Medical Requests -->
                            <div class="bg-white p-4 rounded-lg border border-blue-200">
                                <label class="flex items-center mb-2">
                                    <input type="checkbox" id="otherMedicalRequests" class="ml-2 w-4 h-4 text-blue-600">
                                    <span class="font-semibold text-blue-700">ุทูุจุงุช ุทุจูุฉ ุฃุฎุฑู</span>
                                </label>
                                <div id="otherMedicalRequestsDetails" class="hidden mr-6">
                                    <textarea id="otherMedicalRequestsText" class="w-full p-3 border border-gray-300 rounded-lg text-sm resize-none" rows="4" placeholder="ุงูุชุจ ุฃู ุทูุจุงุช ุทุจูุฉ ุฅุถุงููุฉ ููุง...&#10;ูุซุงู:&#10;โข ุชูููุฑ ุฃุฌูุฒุฉ ููุงุณ ุงูุถุบุท ูุงูุณูุฑ&#10;โข ุชุฎุตูุต ุบุฑูุฉ ุทุจูุฉ ูุฌูุฒุฉ&#10;โข ุชูุณูู ูุน ูุณุชุดูู ูุฑูุจ ููุญุงูุงุช ุงูุทุงุฑุฆุฉ"></textarea>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Support Services Requests Section (for support services notification only) -->
                    <div id="supportServicesSection" class="hidden mt-6 bg-gradient-to-r from-green-50 to-teal-50 p-6 rounded-lg border-2 border-green-300">
                        <h5 class="font-bold text-green-700 mb-4 text-lg flex items-center">
                            <span class="text-2xl ml-2">๐งน</span>
                            ุทูุจุงุช ุงูุฎุฏูุงุช ุงููุณุงูุฏุฉ
                        </h5>
                        
                        <div class="space-y-4">
                            <!-- Training Halls Cleaning -->
                            <div class="bg-white p-4 rounded-lg border border-green-200">
                                <label class="flex items-center mb-2">
                                    <input type="checkbox" id="trainingHallsCleaning" class="ml-2 w-4 h-4 text-green-600" checked>
                                    <span class="font-semibold text-green-700">ุชูุธูู ุดุงูู ูุฌููุน ูุงุนุงุช ุงูุชุฏุฑูุจ ูุงูููุฑุงุช ุงููุญูุทุฉ</span>
                                </label>
                            </div>
                            
                            <!-- Trainee Lounges Cleaning -->
                            <div class="bg-white p-4 rounded-lg border border-green-200">
                                <label class="flex items-center mb-2">
                                    <input type="checkbox" id="traineeLoungeCleaning" class="ml-2 w-4 h-4 text-green-600" checked>
                                    <span class="font-semibold text-green-700">ุชูุธูู ุงุณุชุฑุงุญุงุช ุงููุชุฏุฑุจูู ุฎูุงู ูุชุฑุฉ ุชูููุฐ ุงูุจุฑุงูุฌ</span>
                                </label>
                            </div>
                            
                            <!-- Restrooms Cleaning -->
                            <div class="bg-white p-4 rounded-lg border border-green-200">
                                <label class="flex items-center mb-2">
                                    <input type="checkbox" id="restroomsCleaning" class="ml-2 w-4 h-4 text-green-600">
                                    <span class="font-semibold text-green-700">ุชูุธูู ุฏูุฑุงุช ุงูููุงู ุจุดูู ุฏูุฑู ุฎูุงู ูุชุฑุฉ ุงูุชุฏุฑูุจ</span>
                                </label>
                            </div>
                            
                            <!-- Parking Area Cleaning -->
                            <div class="bg-white p-4 rounded-lg border border-green-200">
                                <label class="flex items-center mb-2">
                                    <input type="checkbox" id="parkingCleaning" class="ml-2 w-4 h-4 text-green-600">
                                    <span class="font-semibold text-green-700">ุชูุธูู ููุงูู ุงูุณูุงุฑุงุช ุงููุฎุตุตุฉ ูููุชุฏุฑุจูู</span>
                                </label>
                            </div>
                            
                            <!-- Entrance Cleaning -->
                            <div class="bg-white p-4 rounded-lg border border-green-200">
                                <label class="flex items-center mb-2">
                                    <input type="checkbox" id="entranceCleaning" class="ml-2 w-4 h-4 text-green-600">
                                    <span class="font-semibold text-green-700">ุชูุธูู ุงููุฏุงุฎู ุงูุฑุฆูุณูุฉ ูููุทูุฉ ุงูุงุณุชูุจุงู</span>
                                </label>
                            </div>
                            
                            <!-- Waste Management -->
                            <div class="bg-white p-4 rounded-lg border border-green-200">
                                <label class="flex items-center mb-2">
                                    <input type="checkbox" id="wasteManagement" class="ml-2 w-4 h-4 text-green-600">
                                    <span class="font-semibold text-green-700">ุฅูุฑุงุบ ุณูุงู ุงูููููุงุช ุจุดูู ุฏูุฑู</span>
                                </label>
                            </div>
                            
                            <!-- Air Conditioning Check -->
                            <div class="bg-white p-4 rounded-lg border border-green-200">
                                <label class="flex items-center mb-2">
                                    <input type="checkbox" id="acCheck" class="ml-2 w-4 h-4 text-green-600">
                                    <span class="font-semibold text-green-700">ุงูุชุฃูุฏ ูู ุฌุงูุฒูุฉ ุฃูุธูุฉ ุงูุชูููู ูู ุงููุงุนุงุช</span>
                                </label>
                            </div>
                            
                            <!-- Lighting Check -->
                            <div class="bg-white p-4 rounded-lg border border-green-200">
                                <label class="flex items-center mb-2">
                                    <input type="checkbox" id="lightingCheck" class="ml-2 w-4 h-4 text-green-600">
                                    <span class="font-semibold text-green-700">ูุญุต ุงูุฅุถุงุกุฉ ูู ุฌููุน ุงููุงุนุงุช ูุงูููุฑุงุช</span>
                                </label>
                            </div>
                            
                            <!-- Other Support Requests -->
                            <div class="bg-white p-4 rounded-lg border border-green-200">
                                <label class="flex items-center mb-2">
                                    <input type="checkbox" id="otherSupportRequests" class="ml-2 w-4 h-4 text-green-600">
                                    <span class="font-semibold text-green-700">ุทูุจุงุช ุฃุฎุฑู</span>
                                </label>
                                <div id="otherSupportRequestsDetails" class="hidden mr-6">
                                    <textarea id="otherSupportRequestsText" class="w-full p-3 border border-gray-300 rounded-lg text-sm resize-none" rows="4" placeholder="ุงูุชุจ ุฃู ุทูุจุงุช ุฅุถุงููุฉ ููุง...&#10;ูุซุงู:&#10;โข ุตูุงูุฉ ุงูุฃุจูุงุจ ูุงูููุงูุฐ&#10;โข ุชุนููู ุงููุงุนุงุช ูุจู ุจุฏุก ุงูุฏูุฑุงุช&#10;โข ุชูููุฑ ูุนููุงุช ูู ุงููุฏุงุฎู"></textarea>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Hospitality Requests Section (for hospitality notification only) -->
                    <div id="hospitalityRequestsSection" class="hidden mt-6 bg-gradient-to-r from-purple-50 to-pink-50 p-6 rounded-lg border-2 border-purple-300">
                        <h5 class="font-bold text-purple-700 mb-4 text-lg flex items-center">
                            <span class="text-2xl ml-2">โ</span>
                            ุทูุจุงุช ุงูุถูุงูุฉ ูุงููุฑุงุณู
                        </h5>
                        
                        <div class="space-y-4">
                            <!-- Reception Hall -->
                            <div class="bg-white p-4 rounded-lg border border-purple-200">
                                <label class="flex items-center mb-2">
                                    <input type="checkbox" id="receptionHall" class="ml-2 w-4 h-4 text-purple-600">
                                    <span class="font-semibold text-purple-700">ุตุงูุฉ ุงูุงุณุชูุจุงู (ูุจูู ุงูุชุฏุฑูุจ)</span>
                                </label>
                                <div id="receptionHallItems" class="hidden mr-6 space-y-1 text-sm text-gray-700">
                                    <label class="flex items-center"><input type="checkbox" class="ml-2 reception-item" checked> ูุฌุจุงุช ุฅูุทุงุฑ ูุงุฎุฑุฉ</label>
                                    <label class="flex items-center"><input type="checkbox" class="ml-2 reception-item" checked> ุงููููุฉ ุงูุณุนูุฏูุฉ</label>
                                    <label class="flex items-center"><input type="checkbox" class="ml-2 reception-item" checked> ุงููููุฉ ุงูุฃูุฑูููุฉ</label>
                                    <label class="flex items-center"><input type="checkbox" class="ml-2 reception-item" checked> ุงูุนุตุงุฆุฑ ุงูุทุงุฒุฌุฉ</label>
                                    <label class="flex items-center"><input type="checkbox" class="ml-2 reception-item" checked> ุงููุดุฑูุจุงุช ุงูุณุงุฎูุฉ</label>
                                    <label class="flex items-center"><input type="checkbox" class="ml-2 reception-item" checked> ุงูููุงู ุงููุนุฏููุฉ</label>
                                    <label class="flex items-center"><input type="checkbox" class="ml-2 reception-item"> ุนุจูุงุช ููุงู ุดุฑุจ ุฒุฌุงุฌูุฉ</label>
                                    <label class="flex items-center"><input type="checkbox" class="ml-2 reception-item"> ุงูุชููุฑ ุงููุงุฎุฑุฉ</label>
                                    <label class="flex items-center"><input type="checkbox" class="ml-2 reception-item"> ุงูููุณุฑุงุช ุงููุดููุฉ</label>
                                    <label class="flex items-center"><input type="checkbox" class="ml-2 reception-item"> ุงูุญูููุงุช ุงูุดุฑููุฉ</label>
                                </div>
                            </div>
                            
                            <!-- Coffee Machines -->
                            <div class="bg-white p-4 rounded-lg border border-purple-200">
                                <label class="flex items-center mb-2">
                                    <input type="checkbox" id="coffeeMachines" class="ml-2 w-4 h-4 text-purple-600">
                                    <span class="font-semibold text-purple-700">ูุงูููุงุช ุงููููุฉ</span>
                                </label>
                                <div id="coffeeMachinesDetails" class="hidden mr-6 text-sm text-gray-700">
                                    <p class="mb-2">ุฅุนุงุฏุฉ ุชุนุจุฆุฉ ูุงูููุงุช ุงููููุฉ ุงูุชุงุจุนุฉ ูุฅุฏุงุฑุฉ ุงูุถูุงูุฉ ูู:</p>
                                    <label class="flex items-center"><input type="checkbox" class="ml-2 coffee-floor" checked> ุงูุฏูุฑ ุงูุฃุฑุถู</label>
                                    <label class="flex items-center"><input type="checkbox" class="ml-2 coffee-floor"> ุงูุฏูุฑ ุงูุฃูู</label>
                                    <label class="flex items-center"><input type="checkbox" class="ml-2 coffee-floor"> ุงูุฏูุฑ ุงูุซุงูู</label>
                                    <label class="flex items-center"><input type="checkbox" class="ml-2 coffee-floor"> ุงูุฏูุฑ ุงูุซุงูุซ</label>
                                    <label class="flex items-center"><input type="checkbox" class="ml-2 coffee-floor" checked> ุงูุฏูุฑ ุงูุฑุงุจุน</label>
                                </div>
                            </div>
                            
                            <!-- Healthy Options -->
                            <div class="bg-white p-4 rounded-lg border border-purple-200">
                                <label class="flex items-center mb-2">
                                    <input type="checkbox" id="healthyOptions" class="ml-2 w-4 h-4 text-purple-600">
                                    <span class="font-semibold text-purple-700">ุถูุงูุฉ ุตุญูุฉ</span>
                                </label>
                                <div id="healthyOptionsDetails" class="hidden mr-6 space-y-1 text-sm text-gray-700">
                                    <label class="flex items-center"><input type="checkbox" class="ml-2 healthy-item" checked> ุฎูุงุฑุงุช ููุงุณุจุฉ ููุฑุถู ุงูุณูุฑู</label>
                                    <label class="flex items-center"><input type="checkbox" class="ml-2 healthy-item" checked> ุฎูุงุฑุงุช ููููุฉ ุงูููุญ (ููุฑุถู ุงูุถุบุท)</label>
                                    <label class="flex items-center"><input type="checkbox" class="ml-2 healthy-item"> ูุดุฑูุจุงุช ุฎุงููุฉ ูู ุงููุงูููู</label>
                                    <label class="flex items-center"><input type="checkbox" class="ml-2 healthy-item"> ููุงูู ุทุงุฒุฌุฉ</label>
                                    <label class="flex items-center"><input type="checkbox" class="ml-2 healthy-item"> ุนุตุงุฆุฑ ุทุจูุนูุฉ ุจุฏูู ุณูุฑ</label>
                                </div>
                            </div>
                            
                            <!-- Training Rooms Water -->
                            <div class="bg-white p-4 rounded-lg border border-purple-200">
                                <label class="flex items-center mb-2">
                                    <input type="checkbox" id="trainingRoomsWater" class="ml-2 w-4 h-4 text-purple-600">
                                    <span class="font-semibold text-purple-700">ููุงู ุงูุดุฑุจ ุฏุงุฎู ูุงุนุงุช ุงูุชุฏุฑูุจ</span>
                                </label>
                                <div id="trainingRoomsWaterDetails" class="hidden mr-6 space-y-1 text-sm text-gray-700">
                                    <label class="flex items-center"><input type="checkbox" class="ml-2 water-item" checked> ููุงู ูุนุฏููุฉ (ุนุจูุงุช ุจูุงุณุชูููุฉ)</label>
                                    <label class="flex items-center"><input type="checkbox" class="ml-2 water-item"> ููุงู ูุนุฏููุฉ (ุนุจูุงุช ุฒุฌุงุฌูุฉ)</label>
                                    <label class="flex items-center"><input type="checkbox" class="ml-2 water-item"> ูุจุฑุฏุงุช ููุงู ูู ุงููุงุนุงุช</label>
                                    <label class="flex items-center"><input type="checkbox" class="ml-2 water-item"> ุฃููุงุจ ูุฑููุฉ</label>
                                </div>
                            </div>
                            
                            <!-- VIP Lounge -->
                            <div class="bg-white p-4 rounded-lg border border-purple-200">
                                <label class="flex items-center mb-2">
                                    <input type="checkbox" id="vipLounge" class="ml-2 w-4 h-4 text-purple-600">
                                    <span class="font-semibold text-purple-700">ุงูุงููุฌ ุงูุทุงุจู ุงูุฑุงุจุน (VIP)</span>
                                </label>
                                <div id="vipLoungeDetails" class="hidden mr-6 space-y-2">
                                    <div>
                                        <label class="block text-sm text-gray-700 mb-1">ุนุฏุฏ ุงูุฃุดุฎุงุต</label>
                                        <input type="number" id="vipGuestCount" class="w-full p-2 border border-gray-300 rounded-lg" placeholder="18">
                                    </div>
                                    <div>
                                        <label class="block text-sm text-gray-700 mb-1">ุงูุชุงุฑูุฎ</label>
                                        <input type="date" id="vipDate" class="w-full p-2 border border-gray-300 rounded-lg">
                                    </div>
                                    <label class="flex items-center">
                                        <input type="checkbox" id="vipLunch" class="ml-2">
                                        <span class="text-sm">ุบุฏุงุก ูู ูุทุนู ุงูุฌุงูุนุฉ</span>
                                    </label>
                                    <div id="vipLunchCount" class="hidden mr-6">
                                        <label class="block text-sm text-gray-700 mb-1">ุนุฏุฏ ุงูุฃุดุฎุงุต ููุบุฏุงุก</label>
                                        <input type="number" id="vipLunchGuestCount" class="w-full p-2 border border-gray-300 rounded-lg" placeholder="20">
                                    </div>
                                </div>
                            </div>
                            
                            <!-- External Hospitality -->
                            <div class="bg-white p-4 rounded-lg border border-purple-200">
                                <label class="flex items-center mb-2">
                                    <input type="checkbox" id="externalHospitality" class="ml-2 w-4 h-4 text-purple-600">
                                    <span class="font-semibold text-purple-700">ุถูุงูุฉ ุฎุงุฑุฌูุฉ</span>
                                </label>
                                <div id="externalHospitalityDetails" class="hidden mr-6 space-y-2">
                                    <div>
                                        <label class="block text-sm text-gray-700 mb-1">ุงููููุน ุงูุฎุงุฑุฌู</label>
                                        <input type="text" id="externalLocation" class="w-full p-2 border border-gray-300 rounded-lg" placeholder="ูุซุงู: ูุฏููุฉ ุชุฏุฑูุจ ุงูุฃูู ุงูุนุงู">
                                    </div>
                                    <div>
                                        <label class="block text-sm text-gray-700 mb-1">ููุช ุงูุชุณููู</label>
                                        <input type="time" id="externalTime" class="w-full p-2 border border-gray-300 rounded-lg" value="08:00">
                                    </div>
                                    <div>
                                        <label class="block text-sm text-gray-700 mb-1">ุงูุนูุงุตุฑ ุงููุทููุจุฉ</label>
                                        <div class="space-y-1 mb-2">
                                            <label class="flex items-center"><input type="checkbox" class="ml-2 external-item" checked> ูุฌุจุงุช ุฅูุทุงุฑ</label>
                                            <label class="flex items-center"><input type="checkbox" class="ml-2 external-item" checked> ูุฑุงุชูู ููุงู ูุนุฏููุฉ</label>
                                            <label class="flex items-center"><input type="checkbox" class="ml-2 external-item" checked> ุนุตุงุฆุฑ ุจุงุฑุฏุฉ</label>
                                            <label class="flex items-center"><input type="checkbox" class="ml-2 external-item"> ูููุฉ ุณุนูุฏูุฉ (ุชุฑุงูุณ)</label>
                                            <label class="flex items-center"><input type="checkbox" class="ml-2 external-item"> ูุดุฑูุจุงุช ุณุงุฎูุฉ</label>
                                            <label class="flex items-center"><input type="checkbox" class="ml-2 external-item"> ุญูููุงุช ููุนุฌูุงุช</label>
                                        </div>
                                        <input type="text" id="externalItemsCustom" class="w-full p-2 border border-gray-300 rounded-lg text-sm" placeholder="ุนูุงุตุฑ ุฅุถุงููุฉ (ุงุฎุชูุงุฑู)">
                                    </div>
                                    <div>
                                        <label class="block text-sm text-gray-700 mb-1">ููุฏูุฑุงุช</label>
                                        <input type="text" id="externalCourses" class="w-full p-2 border border-gray-300 rounded-lg" placeholder="ูุซุงู: ุฌููุน ุฏูุฑุงุช Basic Shooting on Firearm">
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Other Requests -->
                            <div class="bg-white p-4 rounded-lg border border-purple-200">
                                <label class="flex items-center mb-2">
                                    <input type="checkbox" id="otherRequests" class="ml-2 w-4 h-4 text-purple-600">
                                    <span class="font-semibold text-purple-700">ุทูุจุงุช ุฃุฎุฑู</span>
                                </label>
                                <div id="otherRequestsDetails" class="hidden mr-6">
                                    <textarea id="otherRequestsText" class="w-full p-3 border border-gray-300 rounded-lg text-sm resize-none" rows="4" placeholder="ุงูุชุจ ุฃู ุทูุจุงุช ุฅุถุงููุฉ ููุง...&#10;ูุซุงู:&#10;โข ุชูููุฑ ูุชุฑุฌู ููุฑู ููุฏูุฑุงุช ุงูุฏูููุฉ&#10;โข ุชุฌููุฒ ูุงุนุฉ ุงุฌุชูุงุนุงุช ุฎุงุตุฉ&#10;โข ุชุฑุชูุจุงุช ุฎุงุตุฉ ููุถููู"></textarea>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                dynamicFields.appendChild(tableSection);
                
                // Initialize with one row for manual input
                setTimeout(() => addCourseRow(), 100);
            }
            
            formFields.classList.remove('hidden');
        }
        
        let courseRowCounter = 0;
        
        function showManualInput() {
            document.getElementById('manualInputSection').classList.remove('hidden');
            document.getElementById('importInputSection').classList.add('hidden');
            document.getElementById('manualInputBtn').className = 'flex-1 bg-nauss-green text-white px-4 py-3 rounded-lg font-bold transition-colors hover:bg-nauss-dark';
            document.getElementById('importInputBtn').className = 'flex-1 bg-gray-300 text-gray-700 px-4 py-3 rounded-lg font-bold transition-colors hover:bg-gray-400';
        }
        
        function showImportInput() {
            document.getElementById('manualInputSection').classList.add('hidden');
            document.getElementById('importInputSection').classList.remove('hidden');
            document.getElementById('manualInputBtn').className = 'flex-1 bg-gray-300 text-gray-700 px-4 py-3 rounded-lg font-bold transition-colors hover:bg-gray-400';
            document.getElementById('importInputBtn').className = 'flex-1 bg-nauss-green text-white px-4 py-3 rounded-lg font-bold transition-colors hover:bg-nauss-dark';
        }
        
        function importCoursesData() {
            const textarea = document.getElementById('importDataTextarea');
            const data = textarea.value.trim();
            
            if (!data) {
                alert('โ๏ธ ุงูุฑุฌุงุก ูุตู ุงูุจูุงูุงุช ุฃููุงู');
                return;
            }
            
            // Clear existing rows
            const tableBuilder = document.getElementById('coursesTableBuilder');
            tableBuilder.innerHTML = '';
            courseRowCounter = 0;
            
            // Parse data (supports both tab-separated and comma-separated)
            const lines = data.split('\n').filter(line => line.trim());
            let successCount = 0;
            
            lines.forEach(line => {
                // Try tab-separated first (Excel default), then comma-separated
                let parts = line.split('\t').map(p => p.trim());
                if (parts.length < 6) {
                    parts = line.split(',').map(p => p.trim());
                }
                
                if (parts.length >= 6) {
                    courseRowCounter++;
                    const rowDiv = document.createElement('div');
                    rowDiv.className = 'bg-white p-4 rounded-lg mb-4 border border-gray-200';
                    rowDiv.id = `courseRow${courseRowCounter}`;
                    
                    const title = parts[0].trim();
                    const period = parts[1].trim();
                    const participants = parts[2].trim().replace(/\D/g, ''); // Extract numbers only
                    const durationText = parts[3].trim();
                    const duration = durationText.replace(/\D/g, ''); // Extract numbers only
                    const dateRange = parts[4].trim();
                    const location = parts[5].trim();
                    
                    // Parse date range (supports formats like "16 โ 17 / 11 / 2025ู" or "20 / 11 / 2025ู")
                    let startDate = '';
                    let endDate = '';
                    
                    // Remove Arabic "ู" and extra spaces
                    const cleanDateRange = dateRange.replace(/ู/g, '').trim();
                    
                    if (cleanDateRange.includes('โ') || cleanDateRange.includes('-')) {
                        // Range format: "16 โ 17 / 11 / 2025"
                        const dateParts = cleanDateRange.split(/โ|-/).map(p => p.trim());
                        if (dateParts.length === 2) {
                            const startDay = dateParts[0].trim();
                            const endPart = dateParts[1].trim();
                            
                            // Extract month and year from end part
                            const endMatch = endPart.match(/(\d+)\s*\/\s*(\d+)\s*\/\s*(\d+)/);
                            if (endMatch) {
                                const endDay = endMatch[1];
                                const month = endMatch[2].padStart(2, '0');
                                const year = endMatch[3];
                                
                                startDate = `${year}-${month}-${startDay.padStart(2, '0')}`;
                                endDate = `${year}-${month}-${endDay.padStart(2, '0')}`;
                            }
                        }
                    } else {
                        // Single date format: "20 / 11 / 2025"
                        const singleMatch = cleanDateRange.match(/(\d+)\s*\/\s*(\d+)\s*\/\s*(\d+)/);
                        if (singleMatch) {
                            const day = singleMatch[1].padStart(2, '0');
                            const month = singleMatch[2].padStart(2, '0');
                            const year = singleMatch[3];
                            
                            startDate = `${year}-${month}-${day}`;
                            endDate = `${year}-${month}-${day}`;
                        }
                    }
                    
                    rowDiv.innerHTML = `
                        <div class="flex items-center justify-between mb-3">
                            <h5 class="font-bold text-nauss-green">ุงูุฏูุฑุฉ ุฑูู ${courseRowCounter}</h5>
                            <button type="button" onclick="removeCourseRow(${courseRowCounter})" class="text-red-500 hover:text-red-700 font-bold">โ ุญุฐู</button>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-1">ุนููุงู ุงูุฏูุฑุฉ</label>
                                <input type="text" id="courseTitle${courseRowCounter}" value="${title}" class="w-full p-2 border border-gray-300 rounded-lg focus:border-nauss-green focus:outline-none">
                            </div>
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-1">ููุน ุงููุชุฑุฉ</label>
                                <select id="coursePeriod${courseRowCounter}" class="w-full p-2 border border-gray-300 rounded-lg focus:border-nauss-green focus:outline-none">
                                    <option value="ุตุจุงุญูุฉ" ${period === 'ุตุจุงุญูุฉ' ? 'selected' : ''}>ุตุจุงุญูุฉ</option>
                                    <option value="ูุณุงุฆูุฉ" ${period === 'ูุณุงุฆูุฉ' ? 'selected' : ''}>ูุณุงุฆูุฉ</option>
                                    <option value="ููู ูุงูู" ${period === 'ููู ูุงูู' ? 'selected' : ''}>ููู ูุงูู</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-1">ุนุฏุฏ ุงููุดุงุฑููู</label>
                                <input type="number" id="courseParticipants${courseRowCounter}" value="${participants}" class="w-full p-2 border border-gray-300 rounded-lg focus:border-nauss-green focus:outline-none">
                            </div>
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-1">ูุฏุฉ ุงูุจุฑูุงูุฌ (ุจุงูุฃูุงู)</label>
                                <input type="number" id="courseDuration${courseRowCounter}" value="${duration}" class="w-full p-2 border border-gray-300 rounded-lg focus:border-nauss-green focus:outline-none">
                            </div>
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-1">ุชุงุฑูุฎ ุงูุจุฏุงูุฉ</label>
                                <input type="date" id="courseStartDate${courseRowCounter}" value="${startDate}" class="w-full p-2 border border-gray-300 rounded-lg focus:border-nauss-green focus:outline-none">
                            </div>
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-1">ุชุงุฑูุฎ ุงูููุงูุฉ</label>
                                <input type="date" id="courseEndDate${courseRowCounter}" value="${endDate}" class="w-full p-2 border border-gray-300 rounded-lg focus:border-nauss-green focus:outline-none">
                            </div>
                            <div class="md:col-span-2">
                                <label class="block text-sm font-semibold text-gray-700 mb-1">ุงููููุน</label>
                                <input type="text" id="courseLocation${courseRowCounter}" value="${location}" class="w-full p-2 border border-gray-300 rounded-lg focus:border-nauss-green focus:outline-none">
                            </div>
                        </div>
                    `;
                    
                    tableBuilder.appendChild(rowDiv);
                    successCount++;
                }
            });
            
            if (successCount > 0) {
                // Switch to manual input view automatically
                showManualInput();
                textarea.value = '';
                
                // Show success message
                const successMsg = document.createElement('div');
                successMsg.className = 'bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded-lg mb-4';
                successMsg.innerHTML = `
                    <strong>โ ุชู ุงูุงุณุชูุฑุงุฏ ุจูุฌุงุญ!</strong><br>
                    ุชู ุงุณุชูุฑุงุฏ ${successCount} ุฏูุฑุฉ. ููููู ุงูุขู ูุฑุงุฌุนุฉ ุงูุจูุงูุงุช ูุชุนุฏูููุง ุฃู ุญุฐู ุฃู ุฏูุฑุฉ ุบูุฑ ุตุญูุญุฉ.
                `;
                document.getElementById('coursesTableBuilder').insertAdjacentElement('beforebegin', successMsg);
                
                // Remove success message after 5 seconds
                setTimeout(() => successMsg.remove(), 5000);
            } else {
                alert('โ๏ธ ูู ูุชู ุงูุนุซูุฑ ุนูู ุจูุงูุงุช ุตุงูุญุฉ. ุชุฃูุฏ ูู ุชูุณูู ุงูุจูุงูุงุช.');
            }
        }
        
        function addCourseRow() {
            courseRowCounter++;
            const tableBuilder = document.getElementById('coursesTableBuilder');
            
            const rowDiv = document.createElement('div');
            rowDiv.className = 'bg-white p-4 rounded-lg mb-4 border border-gray-200';
            rowDiv.id = `courseRow${courseRowCounter}`;
            rowDiv.innerHTML = `
                <div class="flex items-center justify-between mb-3">
                    <h5 class="font-bold text-nauss-green">ุงูุฏูุฑุฉ ุฑูู ${courseRowCounter}</h5>
                    <button type="button" onclick="removeCourseRow(${courseRowCounter})" class="text-red-500 hover:text-red-700 font-bold">โ ุญุฐู</button>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-1">ุนููุงู ุงูุฏูุฑุฉ</label>
                        <input type="text" id="courseTitle${courseRowCounter}" class="w-full p-2 border border-gray-300 rounded-lg focus:border-nauss-green focus:outline-none" placeholder="ูุซุงู: Basic Shooting on Firearm">
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-1">ููุน ุงููุชุฑุฉ</label>
                        <select id="coursePeriod${courseRowCounter}" class="w-full p-2 border border-gray-300 rounded-lg focus:border-nauss-green focus:outline-none">
                            <option value="ุตุจุงุญูุฉ">ุตุจุงุญูุฉ</option>
                            <option value="ูุณุงุฆูุฉ">ูุณุงุฆูุฉ</option>
                            <option value="ููู ูุงูู">ููู ูุงูู</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-1">ุนุฏุฏ ุงููุดุงุฑููู</label>
                        <input type="number" id="courseParticipants${courseRowCounter}" class="w-full p-2 border border-gray-300 rounded-lg focus:border-nauss-green focus:outline-none" placeholder="20">
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-1">ูุฏุฉ ุงูุจุฑูุงูุฌ (ุจุงูุฃูุงู)</label>
                        <input type="number" id="courseDuration${courseRowCounter}" class="w-full p-2 border border-gray-300 rounded-lg focus:border-nauss-green focus:outline-none" placeholder="2">
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-1">ุชุงุฑูุฎ ุงูุจุฏุงูุฉ</label>
                        <input type="date" id="courseStartDate${courseRowCounter}" class="w-full p-2 border border-gray-300 rounded-lg focus:border-nauss-green focus:outline-none">
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-1">ุชุงุฑูุฎ ุงูููุงูุฉ</label>
                        <input type="date" id="courseEndDate${courseRowCounter}" class="w-full p-2 border border-gray-300 rounded-lg focus:border-nauss-green focus:outline-none">
                    </div>
                    <div class="md:col-span-2">
                        <label class="block text-sm font-semibold text-gray-700 mb-1">ุงููููุน</label>
                        <input type="text" id="courseLocation${courseRowCounter}" class="w-full p-2 border border-gray-300 rounded-lg focus:border-nauss-green focus:outline-none" placeholder="ูุซุงู: ูุฏููุฉ ุชุฏุฑูุจ ุงูุฃูู ุงูุนุงู">
                    </div>
                </div>
            `;
            
            tableBuilder.appendChild(rowDiv);
        }
        
        function removeCourseRow(rowId) {
            const row = document.getElementById(`courseRow${rowId}`);
            if (row) {
                row.remove();
            }
        }

        function generateLetter() {
            const template = letterTemplates[currentCategory][currentLetterType];
            const formData = {};
            
            template.fields.forEach(field => {
                const element = document.getElementById(field.id);
                if (element) {
                    formData[field.id] = element.value;
                }
            });
            
            let letterContent = '';
            
            // Generate specialized report for course opening
            if (currentLetterType === 'course_opening_report') {
                letterContent = generateCourseOpeningReport(formData);
            } else if (currentLetterType === 'course_closing_report') {
                letterContent = generateCourseClosingReport(formData);
            } else if (currentLetterType === 'security_participants_notification') {
                letterContent = generateSecurityNotification(formData);
            } else if (currentLetterType === 'hospitality_notification') {
                letterContent = generateHospitalityNotification(formData);
            } else if (currentLetterType === 'support_services_notification') {
                letterContent = generateSupportServicesNotification(formData);
            } else if (currentLetterType === 'medical_clinic_notification') {
                letterContent = generateMedicalClinicNotification(formData);
            } else {
                // Default simple format for other letter types
                letterContent = `<div style="font-family: 'Cairo', sans-serif; line-height: 2; direction: rtl;">`;
                letterContent += `<h2 style="color: #166764; font-size: 24px; font-weight: bold; margin-bottom: 20px;">${template.title}</h2>`;
                letterContent += `<p style="margin-bottom: 15px;">ุงูุชุงุฑูุฎ: ${new Date().toLocaleDateString('ar-SA')}</p>`;
                
                for (const [key, value] of Object.entries(formData)) {
                    if (value) {
                        const field = template.fields.find(f => f.id === key);
                        if (field) {
                            letterContent += `<p style="margin-bottom: 10px;"><strong>${field.label}:</strong> ${value}</p>`;
                        }
                    }
                }
                
                letterContent += `</div>`;
            }
            
            currentLetterContent = letterContent;
            document.getElementById('letterDisplay').innerHTML = letterContent;
            document.getElementById('letterTypeSection').classList.add('hidden');
            document.getElementById('letterOutput').classList.remove('hidden');
        }
        
        function generateMedicalClinicNotification(data) {
            // Collect courses data from dynamic table
            const courses = [];
            const tableBuilder = document.getElementById('coursesTableBuilder');
            if (tableBuilder) {
                const courseRows = tableBuilder.querySelectorAll('[id^="courseRow"]');
                courseRows.forEach(row => {
                    const rowId = row.id.replace('courseRow', '');
                    const title = document.getElementById(`courseTitle${rowId}`)?.value || '';
                    const period = document.getElementById(`coursePeriod${rowId}`)?.value || '';
                    const participants = document.getElementById(`courseParticipants${rowId}`)?.value || '';
                    const duration = document.getElementById(`courseDuration${rowId}`)?.value || '';
                    const startDate = document.getElementById(`courseStartDate${rowId}`)?.value || '';
                    const endDate = document.getElementById(`courseEndDate${rowId}`)?.value || '';
                    const location = document.getElementById(`courseLocation${rowId}`)?.value || '';
                    
                    if (title) {
                        courses.push({
                            title,
                            period,
                            participants,
                            duration,
                            startDate,
                            endDate,
                            location
                        });
                    }
                });
            }
            
            // Calculate week start date
            let weekStartDate = '';
            let weekStartDay = '';
            
            if (courses.length > 0 && courses[0].startDate) {
                const firstDate = new Date(courses[0].startDate);
                weekStartDate = firstDate.toLocaleDateString('ar', { year: 'numeric', month: 'numeric', day: 'numeric' });
                weekStartDay = firstDate.toLocaleDateString('ar', { weekday: 'long' });
            }
            
            // Generate courses table HTML
            let coursesTableHTML = '';
            courses.forEach(course => {
                const startDateFormatted = course.startDate ? new Date(course.startDate).toLocaleDateString('ar', { day: 'numeric', month: 'numeric', year: 'numeric' }).replace(/\//g, ' / ') : '';
                const endDateFormatted = course.endDate ? new Date(course.endDate).toLocaleDateString('ar', { day: 'numeric', month: 'numeric', year: 'numeric' }).replace(/\//g, ' / ') : '';
                const dateRange = startDateFormatted && endDateFormatted ? `${startDateFormatted} โ ${endDateFormatted}` : '';
                
                coursesTableHTML += `
                    <tr>
                        <td style="padding: 12px; border: 1px solid #3b82f6; text-align: center;">${course.title}</td>
                        <td style="padding: 12px; border: 1px solid #3b82f6; text-align: center;">${course.period}</td>
                        <td style="padding: 12px; border: 1px solid #3b82f6; text-align: center;">${course.participants}</td>
                        <td style="padding: 12px; border: 1px solid #3b82f6; text-align: center;">${course.duration} ${parseInt(course.duration) > 2 ? 'ุฃูุงู' : parseInt(course.duration) === 2 ? 'ูููุงู' : 'ููู'}</td>
                        <td style="padding: 12px; border: 1px solid #3b82f6; text-align: center;">${dateRange}</td>
                        <td style="padding: 12px; border: 1px solid #3b82f6; text-align: center;">${course.location}</td>
                    </tr>
                `;
            });
            
            const totalCourses = courses.length;
            const totalParticipants = courses.reduce((sum, course) => sum + parseInt(course.participants || 0), 0);
            
            // Collect medical requests
            let medicalRequestsHTML = '';
            
            if (document.getElementById('emergencyReadiness')?.checked) {
                medicalRequestsHTML += `<li style="margin-bottom: 10px;">ุงูุงุณุชุนุฏุงุฏ ูุฃู ุญุงูุฉ ุตุญูุฉ ุทุงุฑุฆุฉ ุฎูุงู ูุชุฑุฉ ุงูุชูููุฐ</li>`;
            }
            
            if (document.getElementById('medicalStaffAvailability')?.checked) {
                medicalRequestsHTML += `<li style="margin-bottom: 10px;">ุชูุงุฌุฏ ุทุงูู ุทุจู ูุคูู ุฎูุงู ุณุงุนุงุช ุงูุชุฏุฑูุจ</li>`;
            }
            
            if (document.getElementById('firstAidKit')?.checked) {
                medicalRequestsHTML += `<li style="margin-bottom: 10px;">ุชูููุฑ ุญููุจุฉ ุฅุณุนุงูุงุช ุฃูููุฉ ูู ูุงุนุงุช ุงูุชุฏุฑูุจ</li>`;
            }
            
            if (document.getElementById('ambulanceStandby')?.checked) {
                medicalRequestsHTML += `<li style="margin-bottom: 10px;">ุฌุงูุฒูุฉ ุณูุงุฑุฉ ุฅุณุนุงู ูู ุญุงูุงุช ุงูุทูุงุฑุฆ</li>`;
            }
            
            if (document.getElementById('medicalExamination')?.checked) {
                medicalRequestsHTML += `<li style="margin-bottom: 10px;">ุฅุฌุฑุงุก ูุญุต ุทุจู ูุจุฏุฆู ูููุดุงุฑููู (ุฅู ูุฒู ุงูุฃูุฑ)</li>`;
            }
            
            if (document.getElementById('chronicDiseaseSupport')?.checked) {
                medicalRequestsHTML += `<li style="margin-bottom: 10px;">ุชูููุฑ ุงูุฏุนู ุงูุทุจู ูุญุงูุงุช ุงูุฃูุฑุงุถ ุงููุฒููุฉ</li>`;
            }
            
            if (document.getElementById('emergencyContacts')?.checked) {
                medicalRequestsHTML += `<li style="margin-bottom: 10px;">ุชูููุฑ ุฃุฑูุงู ุงูุทูุงุฑุฆ ุงูุทุจูุฉ ูููุดุฑููู ุงูููุฏุงูููู</li>`;
            }
            
            if (document.getElementById('healthAwareness')?.checked) {
                medicalRequestsHTML += `<li style="margin-bottom: 10px;">ุชูุฒูุน ูุดุฑุงุช ุชูุนููุฉ ุตุญูุฉ ุนูู ุงููุดุงุฑููู</li>`;
            }
            
            // Other Medical Requests
            if (document.getElementById('otherMedicalRequests')?.checked) {
                const otherText = document.getElementById('otherMedicalRequestsText')?.value || '';
                if (otherText.trim()) {
                    const otherLines = otherText.split('\n').filter(line => line.trim());
                    otherLines.forEach(line => {
                        const cleanLine = line.trim().replace(/^[โข\-\*]\s*/, '');
                        if (cleanLine) {
                            medicalRequestsHTML += `<li style="margin-bottom: 10px;">${cleanLine}</li>`;
                        }
                    });
                }
            }
            
            let report = `
            <div style="font-family: 'Cairo', sans-serif; line-height: 1.8; direction: rtl; color: #1f2937;">
                
                <!-- Header -->
                <div style="text-align: center; margin-bottom: 30px; padding: 20px; background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%); color: white; border-radius: 10px;">
                    <h1 style="font-size: 28px; font-weight: bold; margin: 0 0 10px 0;">ุชุจููุบ ุงูุนูุงุฏุฉ ุงูุทุจูุฉ</h1>
                    <p style="font-size: 16px; margin: 0; opacity: 0.9;">ุจุงูุฏูุฑุงุช ุงูุชุฏุฑูุจูุฉ ุงููููุฐุฉ</p>
                </div>
                
                <!-- Recipients -->
                <div style="background-color: #eff6ff; padding: 20px; border-right: 4px solid #3b82f6; margin-bottom: 25px; border-radius: 5px;">
                    <p style="margin: 0; font-size: 16px; line-height: 2;">
                        <strong>ุณุนุงุฏุฉ ูุฏูุฑ ุงูุนูุงุฏุฉ ุงูุทุจูุฉ ุจุงูุฌุงูุนุฉ</strong> <span style="margin-right: 50px;">ุณูููู ุงููู</span>
                    </p>
                </div>
                
                <!-- Greeting -->
                <div style="background-color: #dbeafe; padding: 20px; border-right: 4px solid #3b82f6; margin-bottom: 25px; border-radius: 5px;">
                    <p style="margin: 0; font-size: 16px; line-height: 1.9;">
                        ุงูุณูุงู ุนูููู ูุฑุญูุฉ ุงููู ูุจุฑูุงุชูุ ูุจุนุฏ:<br><br>
                        ุชูุฏููู ุฅุฏุงุฑุฉ ุนูููุงุช ุงูุชุฏุฑูุจ ุจููุงูุฉ ุงูุฌุงูุนุฉ ููุชุฏุฑูุจ ุฃุทูุจ ุงูุชุญุงูุงุ ููููุฏูู ุจุฃูู ุณูุชู ุฎูุงู ุงูุฃุณุจูุน ุงููุงุฏู <strong>${weekStartDay} ${weekStartDate}</strong> ุชูููุฐ ุนุฏุฏ <strong>(${totalCourses})</strong> ูู ุงูุฏูุฑุงุช ุงูุชุฏุฑูุจูุฉ ุฏุงุฎู ููุฑ ุงูุฌุงูุนุฉุ ููุฒุนุฉ ุนูู ุงููุญู ุงูุชุงูู:
                    </p>
                </div>
                
                <!-- Courses Summary -->
                <div style="margin-bottom: 25px;">
                    <h3 style="color: #2563eb; font-size: 20px; font-weight: bold; margin-bottom: 15px; padding-bottom: 10px; border-bottom: 2px solid #93c5fd;">
                        ๐ ุจูุงูุงุช ุงูุฏูุฑุงุช ุงูุชุฏุฑูุจูุฉ
                    </h3>
                    
                    <div style="overflow-x: auto;">
                        <table style="width: 100%; border-collapse: collapse; box-shadow: 0 2px 4px rgba(0,0,0,0.1); background-color: white;">
                            <thead>
                                <tr style="background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%); color: white;">
                                    <th style="padding: 12px; border: 1px solid #3b82f6; text-align: center; font-weight: bold;">ุนููุงู ุงูุฏูุฑุฉ</th>
                                    <th style="padding: 12px; border: 1px solid #3b82f6; text-align: center; font-weight: bold;">ููุน ุงููุชุฑุฉ</th>
                                    <th style="padding: 12px; border: 1px solid #3b82f6; text-align: center; font-weight: bold;">ุนุฏุฏ ุงููุดุงุฑููู</th>
                                    <th style="padding: 12px; border: 1px solid #3b82f6; text-align: center; font-weight: bold;">ูุฏุฉ ุงูุจุฑุงูุฌ</th>
                                    <th style="padding: 12px; border: 1px solid #3b82f6; text-align: center; font-weight: bold;">ุงูุชุงุฑูุฎ</th>
                                    <th style="padding: 12px; border: 1px solid #3b82f6; text-align: center; font-weight: bold;">ุงููููุน</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${coursesTableHTML}
                                <tr style="background-color: #eff6ff; font-weight: bold;">
                                    <td style="padding: 12px; border: 1px solid #3b82f6; text-align: center;">ุงููุฌููุน</td>
                                    <td style="padding: 12px; border: 1px solid #3b82f6; text-align: center;">${totalCourses}</td>
                                    <td style="padding: 12px; border: 1px solid #3b82f6; text-align: center;">${totalParticipants}</td>
                                    <td style="padding: 12px; border: 1px solid #3b82f6; text-align: center;" colspan="3">-</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <!-- Purpose Note -->
                <div style="background-color: #fef3c7; padding: 20px; border-right: 4px solid #f59e0b; margin-bottom: 25px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                    <p style="margin: 0; font-size: 15px; line-height: 1.9; color: #92400e;">
                        <strong>โ๏ธ ุงูุบุฑุถ ูู ุงูุชุจููุบ:</strong><br>
                        ูุฐูู ููุชูุจูู ูุงูุงุณุชุนุฏุงุฏ ูุฃู ุญุงูุฉ ุตุญูุฉ ุทุงุฑุฆุฉ โ <strong>ูุง ูุฏูุฑ ุงููู</strong> โ ุฎูุงู ูุชุฑุฉ ุงูุชูููุฐ.
                    </p>
                </div>
                
                <!-- Requests Section -->
                ${medicalRequestsHTML ? `
                <div style="margin-bottom: 25px;">
                    <h3 style="color: #2563eb; font-size: 20px; font-weight: bold; margin-bottom: 15px; padding-bottom: 10px; border-bottom: 2px solid #93c5fd;">
                        ๐ ุงููุทููุจ ูู ุณุนุงุฏุชูู
                    </h3>
                    
                    <div style="background-color: #eff6ff; padding: 20px; border-right: 4px solid #3b82f6; border-radius: 8px;">
                        <p style="margin: 0 0 15px 0; font-size: 15px; line-height: 1.9; color: #1e40af;">
                            ูุฃูู ูููู ุงูุชูุฑู ุจุงูุชูุฌูู ุจูุง ููุฒู ูู ุชุฑุชูุจุงุช ุทุจูุฉ ููุงุฆูุฉุ ูุชุญุฏูุฏ ูุง ุชุฑููู ููุงุณุจูุง ูู ุฌุงูุฒูุฉ ููู ูุง ุชูุชุถูู ุงูุญุงุฌุฉ:
                        </p>
                        <ol style="margin: 0; padding-right: 25px; color: #1e40af; line-height: 2;">
                            ${medicalRequestsHTML}
                        </ol>
                    </div>
                </div>
                ` : ''}
                
                <!-- Closing -->
                <div style="background-color: #dbeafe; padding: 20px; border-right: 4px solid #93c5fd; margin-top: 30px; border-radius: 5px;">
                    <p style="margin: 0; font-size: 16px; line-height: 1.9;">
                        ุดุงูุฑูู ููู ุชุนุงูููู ุงูุฏุงุฆู ูุงูุชูุงููู ุจุณูุงูุฉ ุงููุดุงุฑููู ูู ุจุฑุงูุฌูุง ุงูุชุฏุฑูุจูุฉ.<br><br>
                        <strong>ูุชูุถููุง ุจูุจูู ูุงูุฑ ุงูุชุญูุฉ ูุงูุชูุฏูุฑุุุ</strong><br><br>
                        ูุฑูู ุนูู ุฅุฏุงุฑุฉ ุนูููุงุช ุงูุชุฏุฑูุจ<br>
                        ููุงูุฉ ุงูุฌุงูุนุฉ ููุชุฏุฑูุจ<br>
                        ุงูุชุงุฑูุฎ: ${new Date().toLocaleDateString('ar', { year: 'numeric', month: 'numeric', day: 'numeric' })}
                    </p>
                </div>
                
            </div>
            `;
            
            return report;
        }
        
        function generateSupportServicesNotification(data) {
            // Collect courses data from dynamic table
            const courses = [];
            const tableBuilder = document.getElementById('coursesTableBuilder');
            if (tableBuilder) {
                const courseRows = tableBuilder.querySelectorAll('[id^="courseRow"]');
                courseRows.forEach(row => {
                    const rowId = row.id.replace('courseRow', '');
                    const title = document.getElementById(`courseTitle${rowId}`)?.value || '';
                    const period = document.getElementById(`coursePeriod${rowId}`)?.value || '';
                    const participants = document.getElementById(`courseParticipants${rowId}`)?.value || '';
                    const duration = document.getElementById(`courseDuration${rowId}`)?.value || '';
                    const startDate = document.getElementById(`courseStartDate${rowId}`)?.value || '';
                    const endDate = document.getElementById(`courseEndDate${rowId}`)?.value || '';
                    const location = document.getElementById(`courseLocation${rowId}`)?.value || '';
                    
                    if (title) {
                        courses.push({
                            title,
                            period,
                            participants,
                            duration,
                            startDate,
                            endDate,
                            location
                        });
                    }
                });
            }
            
            // Calculate week start date
            let weekStartDate = '';
            let weekStartDay = '';
            
            if (courses.length > 0 && courses[0].startDate) {
                const firstDate = new Date(courses[0].startDate);
                weekStartDate = firstDate.toLocaleDateString('ar', { year: 'numeric', month: 'numeric', day: 'numeric' });
                weekStartDay = firstDate.toLocaleDateString('ar', { weekday: 'long' });
            }
            
            // Generate courses table HTML
            let coursesTableHTML = '';
            courses.forEach(course => {
                const startDateFormatted = course.startDate ? new Date(course.startDate).toLocaleDateString('ar', { day: 'numeric', month: 'numeric', year: 'numeric' }).replace(/\//g, ' / ') : '';
                const endDateFormatted = course.endDate ? new Date(course.endDate).toLocaleDateString('ar', { day: 'numeric', month: 'numeric', year: 'numeric' }).replace(/\//g, ' / ') : '';
                const dateRange = startDateFormatted && endDateFormatted ? `${startDateFormatted} โ ${endDateFormatted}` : '';
                
                coursesTableHTML += `
                    <tr>
                        <td style="padding: 12px; border: 1px solid #10b981; text-align: center;">${course.title}</td>
                        <td style="padding: 12px; border: 1px solid #10b981; text-align: center;">${course.period}</td>
                        <td style="padding: 12px; border: 1px solid #10b981; text-align: center;">${course.participants}</td>
                        <td style="padding: 12px; border: 1px solid #10b981; text-align: center;">${course.duration} ${parseInt(course.duration) > 2 ? 'ุฃูุงู' : parseInt(course.duration) === 2 ? 'ูููุงู' : 'ููู'}</td>
                        <td style="padding: 12px; border: 1px solid #10b981; text-align: center;">${dateRange}</td>
                        <td style="padding: 12px; border: 1px solid #10b981; text-align: center;">${course.location}</td>
                    </tr>
                `;
            });
            
            const totalCourses = courses.length;
            const totalParticipants = courses.reduce((sum, course) => sum + parseInt(course.participants || 0), 0);
            
            // Collect support services requests
            let supportRequestsHTML = '';
            
            if (document.getElementById('trainingHallsCleaning')?.checked) {
                supportRequestsHTML += `<li style="margin-bottom: 10px;">ุชูุธูู ุดุงูู ูุฌููุน ูุงุนุงุช ุงูุชุฏุฑูุจ ูุงูููุฑุงุช ุงููุญูุทุฉ</li>`;
            }
            
            if (document.getElementById('traineeLoungeCleaning')?.checked) {
                supportRequestsHTML += `<li style="margin-bottom: 10px;">ุชูุธูู ุงุณุชุฑุงุญุงุช ุงููุชุฏุฑุจูู ุฎูุงู ูุชุฑุฉ ุชูููุฐ ุงูุจุฑุงูุฌ</li>`;
            }
            
            if (document.getElementById('restroomsCleaning')?.checked) {
                supportRequestsHTML += `<li style="margin-bottom: 10px;">ุชูุธูู ุฏูุฑุงุช ุงูููุงู ุจุดูู ุฏูุฑู ุฎูุงู ูุชุฑุฉ ุงูุชุฏุฑูุจ</li>`;
            }
            
            if (document.getElementById('parkingCleaning')?.checked) {
                supportRequestsHTML += `<li style="margin-bottom: 10px;">ุชูุธูู ููุงูู ุงูุณูุงุฑุงุช ุงููุฎุตุตุฉ ูููุชุฏุฑุจูู</li>`;
            }
            
            if (document.getElementById('entranceCleaning')?.checked) {
                supportRequestsHTML += `<li style="margin-bottom: 10px;">ุชูุธูู ุงููุฏุงุฎู ุงูุฑุฆูุณูุฉ ูููุทูุฉ ุงูุงุณุชูุจุงู</li>`;
            }
            
            if (document.getElementById('wasteManagement')?.checked) {
                supportRequestsHTML += `<li style="margin-bottom: 10px;">ุฅูุฑุงุบ ุณูุงู ุงูููููุงุช ุจุดูู ุฏูุฑู</li>`;
            }
            
            if (document.getElementById('acCheck')?.checked) {
                supportRequestsHTML += `<li style="margin-bottom: 10px;">ุงูุชุฃูุฏ ูู ุฌุงูุฒูุฉ ุฃูุธูุฉ ุงูุชูููู ูู ุงููุงุนุงุช</li>`;
            }
            
            if (document.getElementById('lightingCheck')?.checked) {
                supportRequestsHTML += `<li style="margin-bottom: 10px;">ูุญุต ุงูุฅุถุงุกุฉ ูู ุฌููุน ุงููุงุนุงุช ูุงูููุฑุงุช</li>`;
            }
            
            // Other Support Requests
            if (document.getElementById('otherSupportRequests')?.checked) {
                const otherText = document.getElementById('otherSupportRequestsText')?.value || '';
                if (otherText.trim()) {
                    const otherLines = otherText.split('\n').filter(line => line.trim());
                    otherLines.forEach(line => {
                        const cleanLine = line.trim().replace(/^[โข\-\*]\s*/, '');
                        if (cleanLine) {
                            supportRequestsHTML += `<li style="margin-bottom: 10px;">${cleanLine}</li>`;
                        }
                    });
                }
            }
            
            let report = `
            <div style="font-family: 'Cairo', sans-serif; line-height: 1.8; direction: rtl; color: #1f2937;">
                
                <!-- Header -->
                <div style="text-align: center; margin-bottom: 30px; padding: 20px; background: linear-gradient(135deg, #10b981 0%, #059669 100%); color: white; border-radius: 10px;">
                    <h1 style="font-size: 28px; font-weight: bold; margin: 0 0 10px 0;">ุชุจููุบ ุฅุฏุงุฑุฉ ุงูุฎุฏูุงุช ุงููุณุงูุฏุฉ</h1>
                    <p style="font-size: 16px; margin: 0; opacity: 0.9;">ุจุงูุฏูุฑุงุช ุงูุชุฏุฑูุจูุฉ ุงููููุฐุฉ</p>
                </div>
                
                <!-- Recipients -->
                <div style="background-color: #ecfdf5; padding: 20px; border-right: 4px solid #10b981; margin-bottom: 25px; border-radius: 5px;">
                    <p style="margin: 0; font-size: 16px; line-height: 2;">
                        <strong>ุณุนุงุฏุฉ ูุฏูุฑ ุฅุฏุงุฑุฉ ุงูุฎุฏูุงุช ุงููุณุงูุฏุฉ</strong> <span style="margin-right: 50px;">ุณูููู ุงููู</span>
                    </p>
                </div>
                
                <!-- Greeting -->
                <div style="background-color: #f0fdf4; padding: 20px; border-right: 4px solid #10b981; margin-bottom: 25px; border-radius: 5px;">
                    <p style="margin: 0; font-size: 16px; line-height: 1.9;">
                        ุงูุณูุงู ุนูููู ูุฑุญูุฉ ุงููู ูุจุฑูุงุชูุ ูุจุนุฏ:<br><br>
                        ุชูุฏููู ุฅุฏุงุฑุฉ ุนูููุงุช ุงูุชุฏุฑูุจ ูู ููุงูุฉ ุงูุฌุงูุนุฉ ููุชุฏุฑูุจ ุฃุทูุจ ุงูุชุญุงูุงุ ููููุฏูู ุจุฃูู ุณูุชู ุชูููุฐ ุนุฏุฏ <strong>(${totalCourses})</strong> ${totalCourses > 2 ? 'ุฏูุฑุงุช ุชุฏุฑูุจูุฉ' : totalCourses === 2 ? 'ุฏูุฑุชูู ุชุฏุฑูุจูุชูู' : 'ุฏูุฑุฉ ุชุฏุฑูุจูุฉ'} ุจููุฑ ุงูุฌุงูุนุฉ ุฎูุงู ุงููุชุฑุฉ ุงููุงุฏูุฉุ ูุฐูู ุญุณุจ ุงูุชูุตูู ุงูุชุงูู:
                    </p>
                </div>
                
                <!-- Courses Summary -->
                <div style="margin-bottom: 25px;">
                    <h3 style="color: #059669; font-size: 20px; font-weight: bold; margin-bottom: 15px; padding-bottom: 10px; border-bottom: 2px solid #86efac;">
                        ๐ ุจูุงูุงุช ุงูุฏูุฑุงุช ุงูุชุฏุฑูุจูุฉ
                    </h3>
                    
                    <div style="overflow-x: auto;">
                        <table style="width: 100%; border-collapse: collapse; box-shadow: 0 2px 4px rgba(0,0,0,0.1); background-color: white;">
                            <thead>
                                <tr style="background: linear-gradient(135deg, #10b981 0%, #059669 100%); color: white;">
                                    <th style="padding: 12px; border: 1px solid #10b981; text-align: center; font-weight: bold;">ุนููุงู ุงูุฏูุฑุฉ</th>
                                    <th style="padding: 12px; border: 1px solid #10b981; text-align: center; font-weight: bold;">ููุน ุงููุชุฑุฉ</th>
                                    <th style="padding: 12px; border: 1px solid #10b981; text-align: center; font-weight: bold;">ุนุฏุฏ ุงููุดุงุฑููู</th>
                                    <th style="padding: 12px; border: 1px solid #10b981; text-align: center; font-weight: bold;">ูุฏุฉ ุงูุจุฑุงูุฌ</th>
                                    <th style="padding: 12px; border: 1px solid #10b981; text-align: center; font-weight: bold;">ุงูุชุงุฑูุฎ</th>
                                    <th style="padding: 12px; border: 1px solid #10b981; text-align: center; font-weight: bold;">ุงููููุน</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${coursesTableHTML}
                                <tr style="background-color: #ecfdf5; font-weight: bold;">
                                    <td style="padding: 12px; border: 1px solid #10b981; text-align: center;">ุงููุฌููุน</td>
                                    <td style="padding: 12px; border: 1px solid #10b981; text-align: center;">${totalCourses}</td>
                                    <td style="padding: 12px; border: 1px solid #10b981; text-align: center;">${totalParticipants}</td>
                                    <td style="padding: 12px; border: 1px solid #10b981; text-align: center;" colspan="3">-</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <!-- Requests Section -->
                ${supportRequestsHTML ? `
                <div style="margin-bottom: 25px;">
                    <h3 style="color: #059669; font-size: 20px; font-weight: bold; margin-bottom: 15px; padding-bottom: 10px; border-bottom: 2px solid #86efac;">
                        ๐ ุงููุทููุจ ูู ุณุนุงุฏุชูู
                    </h3>
                    
                    <div style="background-color: #ecfdf5; padding: 20px; border-right: 4px solid #10b981; border-radius: 8px;">
                        <p style="margin: 0 0 15px 0; font-size: 15px; line-height: 1.9; color: #065f46;">
                            ูุนูููุ ูุฃูู ูู ุณุนุงุฏุชูู ุงูุชูุฑู ุจุงูุชูุฌูู ูุญู:
                        </p>
                        <ol style="margin: 0; padding-right: 25px; color: #065f46; line-height: 2;">
                            ${supportRequestsHTML}
                        </ol>
                    </div>
                </div>
                ` : ''}
                
                <!-- Closing -->
                <div style="background-color: #f0fdf4; padding: 20px; border-right: 4px solid #86efac; margin-top: 30px; border-radius: 5px;">
                    <p style="margin: 0; font-size: 16px; line-height: 1.9;">
                        ุดุงูุฑูู ููู ุชุนุงูููู ุงูุฏุงุฆูุ ูุชูุถููุง ุจูุจูู ุฃุทูุจ ุงูุชุญุงูุง ูุงูุชูุฏูุฑุุ<br><br>
                        ูุฑูู ุนูู ุฅุฏุงุฑุฉ ุนูููุงุช ุงูุชุฏุฑูุจ<br>
                        ููุงูุฉ ุงูุฌุงูุนุฉ ููุชุฏุฑูุจ<br>
                        ุงูุชุงุฑูุฎ: ${new Date().toLocaleDateString('ar', { year: 'numeric', month: 'numeric', day: 'numeric' })}
                    </p>
                </div>
                
            </div>
            `;
            
            return report;
        }
        
        function generateHospitalityNotification(data) {
            // Collect courses data from dynamic table
            const courses = [];
            const tableBuilder = document.getElementById('coursesTableBuilder');
            if (tableBuilder) {
                const courseRows = tableBuilder.querySelectorAll('[id^="courseRow"]');
                courseRows.forEach(row => {
                    const rowId = row.id.replace('courseRow', '');
                    const title = document.getElementById(`courseTitle${rowId}`)?.value || '';
                    const period = document.getElementById(`coursePeriod${rowId}`)?.value || '';
                    const participants = document.getElementById(`courseParticipants${rowId}`)?.value || '';
                    const duration = document.getElementById(`courseDuration${rowId}`)?.value || '';
                    const startDate = document.getElementById(`courseStartDate${rowId}`)?.value || '';
                    const endDate = document.getElementById(`courseEndDate${rowId}`)?.value || '';
                    const location = document.getElementById(`courseLocation${rowId}`)?.value || '';
                    
                    if (title) {
                        courses.push({
                            title,
                            period,
                            participants,
                            duration,
                            startDate,
                            endDate,
                            location
                        });
                    }
                });
            }
            
            // Get custom break times
            const morningBreak1Start = document.getElementById('morningBreak1Start')?.value || '09:45';
            const morningBreak1End = document.getElementById('morningBreak1End')?.value || '10:15';
            const morningBreak2Start = document.getElementById('morningBreak2Start')?.value || '11:45';
            const morningBreak2End = document.getElementById('morningBreak2End')?.value || '12:15';
            
            const eveningBreak1Start = document.getElementById('eveningBreak1Start')?.value || '17:00';
            const eveningBreak1End = document.getElementById('eveningBreak1End')?.value || '17:10';
            const eveningBreak2Start = document.getElementById('eveningBreak2Start')?.value || '18:10';
            const eveningBreak2End = document.getElementById('eveningBreak2End')?.value || '18:25';
            const eveningBreak3Start = document.getElementById('eveningBreak3Start')?.value || '19:15';
            const eveningBreak3End = document.getElementById('eveningBreak3End')?.value || '19:25';
            
            // Format times to Arabic
            function formatTime(time) {
                const [hours, minutes] = time.split(':');
                const hour = parseInt(hours);
                const period = hour >= 12 ? 'ู' : 'ุต';
                const displayHour = hour > 12 ? hour - 12 : (hour === 0 ? 12 : hour);
                return `${displayHour}:${minutes} ${period}`;
            }
            
            // Calculate week start date
            let weekStartDate = '';
            let weekStartDay = '';
            
            if (courses.length > 0 && courses[0].startDate) {
                const firstDate = new Date(courses[0].startDate);
                weekStartDate = firstDate.toLocaleDateString('ar', { year: 'numeric', month: 'numeric', day: 'numeric' });
                weekStartDay = firstDate.toLocaleDateString('ar', { weekday: 'long' });
            }
            
            // Generate courses table HTML
            let coursesTableHTML = '';
            courses.forEach(course => {
                const startDateFormatted = course.startDate ? new Date(course.startDate).toLocaleDateString('ar', { day: 'numeric', month: 'numeric', year: 'numeric' }).replace(/\//g, ' / ') : '';
                const endDateFormatted = course.endDate ? new Date(course.endDate).toLocaleDateString('ar', { day: 'numeric', month: 'numeric', year: 'numeric' }).replace(/\//g, ' / ') : '';
                const dateRange = startDateFormatted && endDateFormatted ? `${startDateFormatted} โ ${endDateFormatted}` : '';
                
                coursesTableHTML += `
                    <tr>
                        <td style="padding: 12px; border: 1px solid #a855f7; text-align: center;">${course.title}</td>
                        <td style="padding: 12px; border: 1px solid #a855f7; text-align: center;">${course.period}</td>
                        <td style="padding: 12px; border: 1px solid #a855f7; text-align: center;">${course.participants}</td>
                        <td style="padding: 12px; border: 1px solid #a855f7; text-align: center;">${course.duration} ${parseInt(course.duration) > 2 ? 'ุฃูุงู' : parseInt(course.duration) === 2 ? 'ูููุงู' : 'ููู'}</td>
                        <td style="padding: 12px; border: 1px solid #a855f7; text-align: center;">${dateRange}</td>
                        <td style="padding: 12px; border: 1px solid #a855f7; text-align: center;">${course.location}</td>
                    </tr>
                `;
            });
            
            const totalCourses = courses.length;
            const totalParticipants = courses.reduce((sum, course) => sum + parseInt(course.participants || 0), 0);
            
            // Count morning and evening sessions
            const morningSessions = courses.filter(c => c.period === 'ุตุจุงุญูุฉ').length;
            const eveningSessions = courses.filter(c => c.period === 'ูุณุงุฆูุฉ').length;
            
            // Collect hospitality requests
            let hospitalityRequestsHTML = '';
            
            // Reception Hall
            if (document.getElementById('receptionHall')?.checked) {
                const items = [];
                document.querySelectorAll('#receptionHallItems .reception-item:checked').forEach(cb => {
                    items.push(cb.parentElement.textContent.trim());
                });
                if (items.length > 0) {
                    hospitalityRequestsHTML += `
                        <tr>
                            <td style="padding: 12px; border: 1px solid #a855f7; background-color: #faf5ff; font-weight: 600;">ุตุงูุฉ ุงูุงุณุชูุจุงู<br>(ูุจูู ุงูุชุฏุฑูุจ)</td>
                            <td style="padding: 12px; border: 1px solid #a855f7;">
                                ${items.map(item => `โข ${item}`).join('<br>')}
                            </td>
                        </tr>
                    `;
                }
            }
            
            // Coffee Machines
            if (document.getElementById('coffeeMachines')?.checked) {
                const floors = [];
                document.querySelectorAll('#coffeeMachinesDetails .coffee-floor:checked').forEach(cb => {
                    floors.push(cb.parentElement.textContent.trim());
                });
                if (floors.length > 0) {
                    hospitalityRequestsHTML += `
                        <tr>
                            <td style="padding: 12px; border: 1px solid #a855f7; background-color: #faf5ff; font-weight: 600;">ูุงูููุงุช ุงููููุฉ</td>
                            <td style="padding: 12px; border: 1px solid #a855f7;">
                                ุฅุนุงุฏุฉ ุชุนุจุฆุฉ ูุงูููุงุช ุงููููุฉ ุงูุชุงุจุนุฉ ูุฅุฏุงุฑุฉ ุงูุถูุงูุฉ ูู:<br>
                                ${floors.map(floor => `โ ${floor}`).join('<br>')}
                            </td>
                        </tr>
                    `;
                }
            }
            
            // Healthy Options
            if (document.getElementById('healthyOptions')?.checked) {
                const healthyItems = [];
                document.querySelectorAll('#healthyOptionsDetails .healthy-item:checked').forEach(cb => {
                    healthyItems.push(cb.parentElement.textContent.trim());
                });
                if (healthyItems.length > 0) {
                    hospitalityRequestsHTML += `
                        <tr>
                            <td style="padding: 12px; border: 1px solid #a855f7; background-color: #faf5ff; font-weight: 600;">ุถูุงูุฉ ุตุญูุฉ</td>
                            <td style="padding: 12px; border: 1px solid #a855f7;">
                                ${healthyItems.map(item => `โข ${item}`).join('<br>')}
                            </td>
                        </tr>
                    `;
                }
            }
            
            // Training Rooms Water
            if (document.getElementById('trainingRoomsWater')?.checked) {
                const waterItems = [];
                document.querySelectorAll('#trainingRoomsWaterDetails .water-item:checked').forEach(cb => {
                    waterItems.push(cb.parentElement.textContent.trim());
                });
                if (waterItems.length > 0) {
                    hospitalityRequestsHTML += `
                        <tr>
                            <td style="padding: 12px; border: 1px solid #a855f7; background-color: #faf5ff; font-weight: 600;">ุฏุงุฎู ูุงุนุงุช ุงูุชุฏุฑูุจ</td>
                            <td style="padding: 12px; border: 1px solid #a855f7;">
                                ${waterItems.map(item => `โข ${item}`).join('<br>')}
                            </td>
                        </tr>
                    `;
                }
            }
            
            // VIP Lounge
            if (document.getElementById('vipLounge')?.checked) {
                const vipCount = document.getElementById('vipGuestCount')?.value || '18';
                const vipDateValue = document.getElementById('vipDate')?.value || '';
                const vipDateFormatted = vipDateValue ? new Date(vipDateValue).toLocaleDateString('ar', { weekday: 'long', day: 'numeric', month: 'numeric', year: 'numeric' }) : '';
                const hasLunch = document.getElementById('vipLunch')?.checked;
                const lunchCount = document.getElementById('vipLunchGuestCount')?.value || '20';
                
                let vipText = `ุถูุงูุฉ VIP ูุนุฏุฏ ${vipCount} ุดุฎุต ูู ุงูุทุงุจู ุงูุฑุงุจุน`;
                if (vipDateFormatted) {
                    vipText += ` ููู ${vipDateFormatted}`;
                }
                if (hasLunch) {
                    vipText += ` + ุบุฏุงุก ูู ูุทุนู ุงูุฌุงูุนุฉ ูุนุฏุฏ ${lunchCount} ุดุฎุต`;
                }
                
                hospitalityRequestsHTML += `
                    <tr>
                        <td style="padding: 12px; border: 1px solid #a855f7; background-color: #faf5ff; font-weight: 600;">ุงูุงููุฌ ุงูุทุงุจู ุงูุฑุงุจุน</td>
                        <td style="padding: 12px; border: 1px solid #a855f7;">${vipText}</td>
                    </tr>
                `;
            }
            
            // External Hospitality
            if (document.getElementById('externalHospitality')?.checked) {
                const location = document.getElementById('externalLocation')?.value || '';
                const time = document.getElementById('externalTime')?.value || '08:00';
                const coursesText = document.getElementById('externalCourses')?.value || '';
                const customItems = document.getElementById('externalItemsCustom')?.value || '';
                
                const externalItems = [];
                document.querySelectorAll('#externalHospitalityDetails .external-item:checked').forEach(cb => {
                    externalItems.push(cb.parentElement.textContent.trim());
                });
                
                if (customItems) {
                    externalItems.push(customItems);
                }
                
                if (externalItems.length > 0) {
                    let externalText = `ุชุฃููู: ${externalItems.join('ุ ')}`;
                    externalText += `<br>ููุช ุงูุชุณููู: ุงูุณุงุนุฉ ${formatTime(time)}`;
                    if (location) {
                        externalText += `<br>ุงููููุน: ${location}`;
                    }
                    if (coursesText) {
                        externalText += `<br>ููุฏูุฑุงุช: ${coursesText}`;
                    }
                    
                    hospitalityRequestsHTML += `
                        <tr>
                            <td style="padding: 12px; border: 1px solid #a855f7; background-color: #faf5ff; font-weight: 600;">ุถูุงูุฉ ุฎุงุฑุฌูุฉ</td>
                            <td style="padding: 12px; border: 1px solid #a855f7;">${externalText}</td>
                        </tr>
                    `;
                }
            }
            
            // Other Requests
            if (document.getElementById('otherRequests')?.checked) {
                const otherText = document.getElementById('otherRequestsText')?.value || '';
                if (otherText.trim()) {
                    const otherLines = otherText.split('\n').filter(line => line.trim());
                    if (otherLines.length > 0) {
                        let otherHTML = otherLines.map(line => {
                            const cleanLine = line.trim().replace(/^[โข\-\*]\s*/, '');
                            return cleanLine ? `โข ${cleanLine}` : '';
                        }).filter(line => line).join('<br>');
                        
                        hospitalityRequestsHTML += `
                            <tr>
                                <td style="padding: 12px; border: 1px solid #a855f7; background-color: #faf5ff; font-weight: 600;">ุทูุจุงุช ุฃุฎุฑู</td>
                                <td style="padding: 12px; border: 1px solid #a855f7;">${otherHTML}</td>
                            </tr>
                        `;
                    }
                }
            }
            
            let report = `
            <div style="font-family: 'Cairo', sans-serif; line-height: 1.8; direction: rtl; color: #1f2937;">
                
                <!-- Header -->
                <div style="text-align: center; margin-bottom: 30px; padding: 20px; background: linear-gradient(135deg, #a855f7 0%, #7c3aed 100%); color: white; border-radius: 10px;">
                    <h1 style="font-size: 28px; font-weight: bold; margin: 0 0 10px 0;">ุชุจููุบ ุงููุฑุงุณู ูุงูุถูุงูุฉ</h1>
                    <p style="font-size: 16px; margin: 0; opacity: 0.9;">ุจุชูููุฐ ุงูุฏูุฑุงุช ุงูุชุฏุฑูุจูุฉ</p>
                </div>
                
                <!-- Recipients -->
                <div style="background-color: #faf5ff; padding: 20px; border-right: 4px solid #a855f7; margin-bottom: 25px; border-radius: 5px;">
                    <p style="margin: 0; font-size: 16px; line-height: 2;">
                        <strong>ุณุนุงุฏุฉ ูุฏูุฑ ุฅุฏุงุฑุฉ ุงูุถูุงูุฉ ูุงูุฅุณูุงู ุจุงูุฌุงูุนุฉ</strong> <span style="margin-right: 50px;">ุณูููู ุงููู</span><br>
                        <strong>ุณุนุงุฏุฉ ูุฏูุฑ ุฅุฏุงุฑุฉ ุงููุฑุงุณู ุจุงูุฌุงูุนุฉ</strong> <span style="margin-right: 50px;">ุณูููู ุงููู</span>
                    </p>
                </div>
                
                <!-- Greeting -->
                <div style="background-color: #f5f3ff; padding: 20px; border-right: 4px solid #a855f7; margin-bottom: 25px; border-radius: 5px;">
                    <p style="margin: 0; font-size: 16px; line-height: 1.9;">
                        ุงูุณูุงู ุนูููู ูุฑุญูุฉ ุงููู ูุจุฑูุงุชูุ ูุจุนุฏ:<br><br>
                        ุชูุฏููู ุฅุฏุงุฑุฉ ุนูููุงุช ุงูุชุฏุฑูุจ ุจููุงูุฉ ุงูุฌุงูุนุฉ ููุชุฏุฑูุจ ุฃุทูุจ ุงูุชุญุงูุงุ ูููุฏ ุฅุดุนุงุฑูู ุจุฃูู ุณูุชู ุฎูุงู ุงูุฃุณุจูุน ุงููุงุฏู ุชูููุฐ ุนุฏุฏ <strong>(${totalCourses})</strong> ${totalCourses > 2 ? 'ุฏูุฑุงุช ุชุฏุฑูุจูุฉ' : totalCourses === 2 ? 'ุฏูุฑุชูู ุชุฏุฑูุจูุชูู' : 'ุฏูุฑุฉ ุชุฏุฑูุจูุฉ'} ูู ููุฑ ุงูุฌุงูุนุฉุ ูุฐูู ุฎูุงู ุงููุชุฑุฉ ูู <strong>${weekStartDay} ${weekStartDate}</strong>
                    </p>
                </div>
                
                <!-- Courses Summary -->
                <div style="margin-bottom: 25px;">
                    <h3 style="color: #7c3aed; font-size: 20px; font-weight: bold; margin-bottom: 15px; padding-bottom: 10px; border-bottom: 2px solid #c4b5fd;">
                        ๐ ุจูุงูุงุช ุนุงูุฉ ููุฏูุฑุงุช ุงูุชุฏุฑูุจูุฉ
                    </h3>
                    
                    <div style="overflow-x: auto;">
                        <table style="width: 100%; border-collapse: collapse; box-shadow: 0 2px 4px rgba(0,0,0,0.1); background-color: white;">
                            <thead>
                                <tr style="background: linear-gradient(135deg, #a855f7 0%, #7c3aed 100%); color: white;">
                                    <th style="padding: 12px; border: 1px solid #a855f7; text-align: center; font-weight: bold;">ุนููุงู ุงูุฏูุฑุฉ</th>
                                    <th style="padding: 12px; border: 1px solid #a855f7; text-align: center; font-weight: bold;">ููุน ุงููุชุฑุฉ</th>
                                    <th style="padding: 12px; border: 1px solid #a855f7; text-align: center; font-weight: bold;">ุนุฏุฏ ุงููุดุงุฑููู</th>
                                    <th style="padding: 12px; border: 1px solid #a855f7; text-align: center; font-weight: bold;">ูุฏุฉ ุงูุจุฑุงูุฌ</th>
                                    <th style="padding: 12px; border: 1px solid #a855f7; text-align: center; font-weight: bold;">ุงูุชุงุฑูุฎ</th>
                                    <th style="padding: 12px; border: 1px solid #a855f7; text-align: center; font-weight: bold;">ุงููููุน</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${coursesTableHTML}
                                <tr style="background-color: #faf5ff; font-weight: bold;">
                                    <td style="padding: 12px; border: 1px solid #a855f7; text-align: center;">ุงููุฌููุน</td>
                                    <td style="padding: 12px; border: 1px solid #a855f7; text-align: center;">${totalCourses}</td>
                                    <td style="padding: 12px; border: 1px solid #a855f7; text-align: center;">${totalParticipants}</td>
                                    <td style="padding: 12px; border: 1px solid #a855f7; text-align: center;" colspan="3">-</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <!-- Break Times -->
                ${morningSessions > 0 ? `
                <div style="margin-bottom: 25px; background-color: #fef3c7; padding: 20px; border-right: 4px solid #f59e0b; border-radius: 8px;">
                    <h3 style="color: #d97706; font-size: 18px; font-weight: bold; margin: 0 0 15px 0; display: flex; align-items: center;">
                        <span style="font-size: 24px; margin-left: 8px;">๐</span>
                        ุฃููุงุช ุงูุฑุงุญุฉ ููุฏูุฑุงุช ุงูุตุจุงุญูุฉ
                    </h3>
                    <table style="width: 100%; border-collapse: collapse;">
                        <thead>
                            <tr style="background-color: #fde68a;">
                                <th style="padding: 10px; border: 1px solid #f59e0b; text-align: center; font-weight: bold;">ุงููุชุฑุฉ</th>
                                <th style="padding: 10px; border: 1px solid #f59e0b; text-align: center; font-weight: bold;">ุงูุชูููุช</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td style="padding: 10px; border: 1px solid #f59e0b; text-align: center;">ุงูุฑุงุญุฉ ุงูุฃููู</td>
                                <td style="padding: 10px; border: 1px solid #f59e0b; text-align: center;">ูู ${formatTime(morningBreak1Start)} ุฅูู ${formatTime(morningBreak1End)}</td>
                            </tr>
                            <tr>
                                <td style="padding: 10px; border: 1px solid #f59e0b; text-align: center;">ุงูุฑุงุญุฉ ุงูุซุงููุฉ</td>
                                <td style="padding: 10px; border: 1px solid #f59e0b; text-align: center;">ูู ${formatTime(morningBreak2Start)} ุฅูู ${formatTime(morningBreak2End)}</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                ` : ''}
                
                ${eveningSessions > 0 ? `
                <div style="margin-bottom: 25px; background-color: #dbeafe; padding: 20px; border-right: 4px solid #3b82f6; border-radius: 8px;">
                    <h3 style="color: #1e40af; font-size: 18px; font-weight: bold; margin: 0 0 15px 0; display: flex; align-items: center;">
                        <span style="font-size: 24px; margin-left: 8px;">๐</span>
                        ุฃููุงุช ุงูุฑุงุญุฉ ููุฏูุฑุงุช ุงููุณุงุฆูุฉ
                    </h3>
                    <table style="width: 100%; border-collapse: collapse;">
                        <thead>
                            <tr style="background-color: #bfdbfe;">
                                <th style="padding: 10px; border: 1px solid #3b82f6; text-align: center; font-weight: bold;">ุงููุชุฑุฉ</th>
                                <th style="padding: 10px; border: 1px solid #3b82f6; text-align: center; font-weight: bold;">ุงูุชูููุช</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td style="padding: 10px; border: 1px solid #3b82f6; text-align: center;">ุงูุฑุงุญุฉ ุงูุฃููู</td>
                                <td style="padding: 10px; border: 1px solid #3b82f6; text-align: center;">ูู ${formatTime(eveningBreak1Start)} ุฅูู ${formatTime(eveningBreak1End)}</td>
                            </tr>
                            <tr>
                                <td style="padding: 10px; border: 1px solid #3b82f6; text-align: center;">ุงูุฑุงุญุฉ ุงูุซุงููุฉ</td>
                                <td style="padding: 10px; border: 1px solid #3b82f6; text-align: center;">ูู ${formatTime(eveningBreak2Start)} ุฅูู ${formatTime(eveningBreak2End)}</td>
                            </tr>
                            <tr>
                                <td style="padding: 10px; border: 1px solid #3b82f6; text-align: center;">ุงูุฑุงุญุฉ ุงูุซุงูุซุฉ</td>
                                <td style="padding: 10px; border: 1px solid #3b82f6; text-align: center;">ูู ${formatTime(eveningBreak3Start)} ุฅูู ${formatTime(eveningBreak3End)}</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                ` : ''}
                
                <!-- Hospitality Requests -->
                ${hospitalityRequestsHTML ? `
                <div style="margin-bottom: 25px;">
                    <h3 style="color: #7c3aed; font-size: 20px; font-weight: bold; margin-bottom: 15px; padding-bottom: 10px; border-bottom: 2px solid #c4b5fd;">
                        ๐ ุงูุทูุจุงุช ุงููุทููุจ ุชุฃููููุง ุฎูุงู ูุชุฑุงุช ุงูุงุณุชุฑุงุญุฉ
                    </h3>
                    
                    <div style="overflow-x: auto;">
                        <table style="width: 100%; border-collapse: collapse; box-shadow: 0 2px 4px rgba(0,0,0,0.1); background-color: white;">
                            <thead>
                                <tr style="background: linear-gradient(135deg, #a855f7 0%, #7c3aed 100%); color: white;">
                                    <th style="padding: 12px; border: 1px solid #a855f7; text-align: center; font-weight: bold; width: 30%;">ุงููุฆุฉ / ุงููููุน</th>
                                    <th style="padding: 12px; border: 1px solid #a855f7; text-align: center; font-weight: bold;">ุงูุนูุงุตุฑ ุงููุทููุจุฉ</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${hospitalityRequestsHTML}
                            </tbody>
                        </table>
                    </div>
                </div>
                ` : ''}
                
                <!-- Closing -->
                <div style="background-color: #faf5ff; padding: 20px; border-right: 4px solid #c4b5fd; margin-top: 30px; border-radius: 5px;">
                    <p style="margin: 0; font-size: 16px; line-height: 1.9;">
                        ูุฃูู ูููู ุงูุชูุฑู ุจุงูุชูุฌูู ููู ููุฒู ุจุงุชุฎุงุฐ ูุง ููุฒู ูู ุชุฌููุฒุงุช ููู ูุง ูุฑุฏ ุฃุนูุงูุ ุจูุง ูุถูู ุฌุงูุฒูุฉ ุงูุถูุงูุฉ ุฎูุงู ูุชุฑุงุช ุงูุชุฏุฑูุจ.<br><br>
                        <strong>ูุชูุถููุง ุจูุจูู ูุงูุฑ ุงูุชุญูุฉ ูุงูุชูุฏูุฑุุุ</strong><br><br>
                        ูุฑูู ุนูู ุฅุฏุงุฑุฉ ุนูููุงุช ุงูุชุฏุฑูุจ<br>
                        ููุงูุฉ ุงูุฌุงูุนุฉ ููุชุฏุฑูุจ<br>
                        ุงูุชุงุฑูุฎ: ${new Date().toLocaleDateString('ar', { year: 'numeric', month: 'numeric', day: 'numeric' })}
                    </p>
                </div>
                
            </div>
            `;
            
            return report;
        }
        
        function generateSecurityNotification(data) {
            // Collect courses data from dynamic table
            const courses = [];
            const tableBuilder = document.getElementById('coursesTableBuilder');
            if (tableBuilder) {
                const courseRows = tableBuilder.querySelectorAll('[id^="courseRow"]');
                courseRows.forEach(row => {
                    const rowId = row.id.replace('courseRow', '');
                    const title = document.getElementById(`courseTitle${rowId}`)?.value || '';
                    const period = document.getElementById(`coursePeriod${rowId}`)?.value || '';
                    const participants = document.getElementById(`courseParticipants${rowId}`)?.value || '';
                    const duration = document.getElementById(`courseDuration${rowId}`)?.value || '';
                    const startDate = document.getElementById(`courseStartDate${rowId}`)?.value || '';
                    const endDate = document.getElementById(`courseEndDate${rowId}`)?.value || '';
                    const location = document.getElementById(`courseLocation${rowId}`)?.value || '';
                    
                    if (title) {
                        courses.push({
                            title,
                            period,
                            participants,
                            duration,
                            startDate,
                            endDate,
                            location
                        });
                    }
                });
            }
            
            // Get additional requests
            const additionalRequestsText = document.getElementById('additionalRequests')?.value || '';
            let additionalRequestsHTML = '';
            if (additionalRequestsText.trim()) {
                const requestLines = additionalRequestsText.split('\n').filter(line => line.trim());
                requestLines.forEach(line => {
                    const cleanLine = line.trim().replace(/^[โข\-\*]\s*/, '');
                    if (cleanLine) {
                        additionalRequestsHTML += `
                            <li style="margin-bottom: 12px;">
                                ${cleanLine}
                            </li>
                        `;
                    }
                });
            }
            
            // Auto-calculate from courses data
            let weekStartDate = '';
            let weekStartDay = '';
            
            if (courses.length > 0 && courses[0].startDate) {
                const firstDate = new Date(courses[0].startDate);
                weekStartDate = firstDate.toLocaleDateString('ar', { year: 'numeric', month: 'numeric', day: 'numeric' });
                weekStartDay = firstDate.toLocaleDateString('ar', { weekday: 'long' });
            }
            
            // Generate courses table HTML
            let coursesTableHTML = '';
            courses.forEach(course => {
                const startDateFormatted = course.startDate ? new Date(course.startDate).toLocaleDateString('ar', { day: 'numeric', month: 'numeric', year: 'numeric' }).replace(/\//g, ' / ') : '';
                const endDateFormatted = course.endDate ? new Date(course.endDate).toLocaleDateString('ar', { day: 'numeric', month: 'numeric', year: 'numeric' }).replace(/\//g, ' / ') : '';
                const dateRange = startDateFormatted && endDateFormatted ? `${startDateFormatted} โ ${endDateFormatted}` : '';
                
                coursesTableHTML += `
                    <tr>
                        <td style="padding: 12px; border: 1px solid #166764; text-align: center;">${course.title}</td>
                        <td style="padding: 12px; border: 1px solid #166764; text-align: center;">${course.period}</td>
                        <td style="padding: 12px; border: 1px solid #166764; text-align: center;">${course.participants}</td>
                        <td style="padding: 12px; border: 1px solid #166764; text-align: center;">${course.duration} ${parseInt(course.duration) > 2 ? 'ุฃูุงู' : parseInt(course.duration) === 2 ? 'ูููุงู' : 'ููู'}</td>
                        <td style="padding: 12px; border: 1px solid #166764; text-align: center;">${dateRange}</td>
                        <td style="padding: 12px; border: 1px solid #166764; text-align: center;">${course.location}</td>
                    </tr>
                `;
            });
            
            const totalCourses = courses.length;
            const totalParticipants = courses.reduce((sum, course) => sum + parseInt(course.participants || 0), 0);
            
            let report = `
            <div style="font-family: 'Cairo', sans-serif; line-height: 1.8; direction: rtl; color: #1f2937;">
                
                <!-- Header -->
                <div style="text-align: center; margin-bottom: 30px; padding: 20px; background: linear-gradient(135deg, #166764 0%, #0f4c49 100%); color: white; border-radius: 10px;">
                    <h1 style="font-size: 28px; font-weight: bold; margin: 0 0 10px 0;">ุชุจููุบ ุฅุฏุงุฑุฉ ุงูุฃูู ูุงูุณูุงูุฉ</h1>
                    <p style="font-size: 16px; margin: 0; opacity: 0.9;">ุจุฃุณูุงุก ุงููุดุงุฑููู ูู ุงูุฏูุฑุงุช ุงูุชุฏุฑูุจูุฉ</p>
                </div>
                
                <!-- Greeting -->
                <div style="background-color: #f0f4f3; padding: 20px; border-right: 4px solid #166764; margin-bottom: 25px; border-radius: 5px;">
                    <p style="margin: 0; font-size: 16px; line-height: 1.9;">
                        <strong>ุณุนุงุฏุฉ ูุฏูุฑ ุฅุฏุงุฑุฉ ุงูุฃูู ูุงูุณูุงูุฉ</strong> <span style="margin-right: 50px;">ุณูููู ุงููู</span><br><br>
                        ุงูุณูุงู ุนูููู ูุฑุญูุฉ ุงููู ูุจุฑูุงุชูุ ูุจุนุฏ:<br><br>
                        ุชูุฏููู ุฅุฏุงุฑุฉ ุนูููุงุช ุงูุชุฏุฑูุจ ุจููุงูุฉ ุงูุฌุงูุนุฉ ููุชุฏุฑูุจ ุฃุทูุจ ุงูุชุญุงูุงุ ูุชููุฏูู ุจุฃูู ุณูุชู ุฎูุงู ุงูุฃุณุจูุน ุงููุงุฏู ุชูููุฐ ุนุฏุฏ <strong>(${totalCourses})</strong> ูู ุงูุฏูุฑุงุช ุงูุชุฏุฑูุจูุฉ ุฏุงุฎู ููุฑ ุงูุฌุงูุนุฉุ ูุชุจุฏุฃ ูู ููู <strong>(${weekStartDay})</strong> ุงูููุงูู <strong>(${weekStartDate})</strong>.
                    </p>
                </div>
                
                <!-- Courses Summary -->
                <div style="margin-bottom: 25px;">
                    <h3 style="color: #166764; font-size: 20px; font-weight: bold; margin-bottom: 15px; padding-bottom: 10px; border-bottom: 2px solid #cdb081;">
                        ๐ ููุฎุต ุงููุนูููุงุช ุงูุฃุณุงุณูุฉ ุญูู ุงูุฏูุฑุงุช ุงููุฌุฏููุฉ
                    </h3>
                    
                    <div style="overflow-x: auto;">
                        <table style="width: 100%; border-collapse: collapse; box-shadow: 0 2px 4px rgba(0,0,0,0.1); background-color: white;">
                            <thead>
                                <tr style="background: linear-gradient(135deg, #166764 0%, #0f4c49 100%); color: white;">
                                    <th style="padding: 12px; border: 1px solid #166764; text-align: center; font-weight: bold;">ุนููุงู ุงูุฏูุฑุฉ</th>
                                    <th style="padding: 12px; border: 1px solid #166764; text-align: center; font-weight: bold;">ููุน ุงููุชุฑุฉ</th>
                                    <th style="padding: 12px; border: 1px solid #166764; text-align: center; font-weight: bold;">ุนุฏุฏ ุงููุดุงุฑููู</th>
                                    <th style="padding: 12px; border: 1px solid #166764; text-align: center; font-weight: bold;">ูุฏุฉ ุงูุจุฑุงูุฌ</th>
                                    <th style="padding: 12px; border: 1px solid #166764; text-align: center; font-weight: bold;">ุงูุชุงุฑูุฎ</th>
                                    <th style="padding: 12px; border: 1px solid #166764; text-align: center; font-weight: bold;">ุงููููุน</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${coursesTableHTML}
                                <tr style="background-color: #f0f4f3; font-weight: bold;">
                                    <td style="padding: 12px; border: 1px solid #166764; text-align: center;">ุงููุฌููุน</td>
                                    <td style="padding: 12px; border: 1px solid #166764; text-align: center;">${totalCourses}</td>
                                    <td style="padding: 12px; border: 1px solid #166764; text-align: center;">${totalParticipants}</td>
                                    <td style="padding: 12px; border: 1px solid #166764; text-align: center;" colspan="3">-</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <!-- Attachments Note -->
                <div style="background-color: #eff6ff; padding: 20px; border-right: 4px solid #2563eb; margin-bottom: 25px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                    <p style="margin: 0; font-size: 15px; line-height: 1.9; color: #1e3a8a;">
                        <strong>๐ ุงููุฑููุงุช:</strong><br>
                        ูุชุฌุฏูู ูู ุงููุฑููุงุช ุฌููุน ุงููุนูููุงุช ุงูุชูุตูููุฉุ ุจูุง ูู ุฐูู ุฃุณูุงุก ุงููุดุงุฑููู ููุดุฑู ุงูุนูููุงุช ุงููุณุคูู ุนู ูู ุฏูุฑุฉ.
                    </p>
                </div>
                
                <!-- Requests Section -->
                <div style="margin-bottom: 25px;">
                    <h3 style="color: #166764; font-size: 20px; font-weight: bold; margin-bottom: 15px; padding-bottom: 10px; border-bottom: 2px solid #cdb081;">
                        ๐ ุงููุทููุจ ูู ุณุนุงุฏุชูู
                    </h3>
                    
                    <div style="background-color: #ecfdf5; padding: 20px; border-right: 4px solid #059669; border-radius: 8px;">
                        <p style="margin: 0 0 15px 0; font-size: 15px; line-height: 1.9; color: #065f46;">
                            ูุฃูู ูู ุณุนุงุฏุชูู ุงูุชูุฑู ุจุงูุชูุฌูู ุฅูู ูู ููุฒู ุจู:
                        </p>
                        <ol style="margin: 0; padding-right: 25px; color: #065f46; line-height: 2;">
                            <li style="margin-bottom: 12px;">
                                <strong>ุชุณููู ุฏุฎูู ุงููุดุงุฑููู</strong> ุนุจุฑ ุงูุจูุงุจุฉ ุฑูู <strong>(4)</strong> ุทููุฉ ุฃูุงู ุงูุนูุงุฏ ุงูุฏูุฑุงุช.
                            </li>
                            <li style="margin-bottom: 12px;">
                                <strong>ุฅุจูุงุบ ูุดุฑูู ุงูุฃูู</strong> ุจุถุฑูุฑุฉ ุชูุฌูู ุงููุดุงุฑููู ุฅูู ููุฑุงุช ุงูุชุฏุฑูุจ ุงููุญุฏุฏุฉ ุฏุงุฎู ูุจูู ุงูุชุฏุฑูุจ.
                            </li>
                            <li style="margin-bottom: 12px;">
                                <strong>ุงููุชุงุจุนุฉ ุงูุฏูุฑูุฉ</strong> ูู ูุจู ูุดุฑูู ุงูุฃูู ูู ุงูููุฑุงุช ููุงุนุงุช ุงูุชุฏุฑูุจุ ููุชุฃูุฏ ูู ุงูุณูุงูุฉ ุงูุนุงูุฉ ุฏูู ุงูุชุฃุซูุฑ ุนูู ุณูุฑ ุงูุจุฑูุงูุฌ ุงูุชุฏุฑูุจู.
                            </li>
                            ${additionalRequestsHTML}
                        </ol>
                    </div>
                </div>
                
                <!-- Closing -->
                <div style="background-color: #f0f4f3; padding: 20px; border-right: 4px solid #cdb081; margin-top: 30px; border-radius: 5px;">
                    <p style="margin: 0; font-size: 16px; line-height: 1.9;">
                        ูุน ุจุงูุบ ุงูุดูุฑ ูุงูุชูุฏูุฑ ูุชุนุงูููู ุงูุฏุงุฆูุ ูุญุฑุตูู ุงููุดููุฏ ุนูู ุชุณููู ุชูููุฐ ุงูุจุฑุงูุฌ ุงูุชุฏุฑูุจูุฉ.<br><br>
                        <strong>ูุชูุถููุง ุจูุจูู ูุงูุฑ ุงูุชุญูุฉ ูุงูุชูุฏูุฑุุุ</strong><br><br>
                        ูุฑูู ุนูู ุฅุฏุงุฑุฉ ุนูููุงุช ุงูุชุฏุฑูุจ<br>
                        ููุงูุฉ ุงูุฌุงูุนุฉ ููุชุฏุฑูุจ<br>
                        ุงูุชุงุฑูุฎ: ${new Date().toLocaleDateString('ar', { year: 'numeric', month: 'numeric', day: 'numeric' })}
                    </p>
                </div>
                
            </div>
            `;
            
            return report;
        }
        
        function generateCourseOpeningReport(data) {
            const startDate = data.startDate ? new Date(data.startDate).toLocaleDateString('ar', { year: 'numeric', month: 'numeric', day: 'numeric' }) : '';
            const endDate = data.endDate ? new Date(data.endDate).toLocaleDateString('ar', { year: 'numeric', month: 'numeric', day: 'numeric' }) : '';
            const coursePeriod = startDate && endDate ? `${startDate} - ${endDate}` : '';
            
            // Calculate working days
            let workingDays = 0;
            if (data.startDate && data.endDate) {
                const start = new Date(data.startDate);
                const end = new Date(data.endDate);
                let current = new Date(start);
                while (current <= end) {
                    const dayOfWeek = current.getDay();
                    if (dayOfWeek >= 0 && dayOfWeek <= 4) { // Sunday to Thursday
                        workingDays++;
                    }
                    current.setDate(current.getDate() + 1);
                }
            }
            
            // AI-enhanced content generation
            const attendanceRate = data.participantCount && data.actualAttendance 
                ? ((data.actualAttendance / data.participantCount) * 100).toFixed(1) 
                : '100';
            
            // AI: Generate attendance analysis
            let attendanceAnalysis = '';
            if (attendanceRate >= 95) {
                attendanceAnalysis = 'ูุณุจุฉ ุญุถูุฑ ููุชุงุฒุฉ ุชุนูุณ ุงูุชุฒุงู ุงููุดุงุฑููู ูุฌูุฏุฉ ุงูุชูุณูู ุงููุณุจู';
            } else if (attendanceRate >= 85) {
                attendanceAnalysis = 'ูุณุจุฉ ุญุถูุฑ ุฌูุฏุฉ ุฌุฏุงู ูุน ูุฌูุฏ ุจุนุถ ุงูุบูุงุจุงุช ุงููุจุฑุฑุฉ';
            } else if (attendanceRate >= 75) {
                attendanceAnalysis = 'ูุณุจุฉ ุญุถูุฑ ููุจููุฉุ ูููุตุญ ุจูุชุงุจุนุฉ ุฃุณุจุงุจ ุงูุบูุงุจ';
            } else {
                attendanceAnalysis = 'ูุณุจุฉ ุญุถูุฑ ุชุญุชุงุฌ ุฅูู ุชุญุณููุ ูููุตู ุจุฏุฑุงุณุฉ ุงูุฃุณุจุงุจ ูุงุชุฎุงุฐ ุงูุฅุฌุฑุงุกุงุช ุงููุงุฒูุฉ';
            }
            
            // AI: Enhance positives section
            let enhancedPositives = data.positives || '';
            if (enhancedPositives) {
                const positivesLines = enhancedPositives.split('\n').filter(line => line.trim());
                enhancedPositives = positivesLines.map((line, index) => 
                    `${index + 1}. ${line.trim()}`
                ).join('\n');
            }
            
            // AI: Enhance negatives section
            let enhancedNegatives = data.negatives || '';
            if (enhancedNegatives) {
                const negativesLines = enhancedNegatives.split('\n').filter(line => line.trim());
                enhancedNegatives = negativesLines.map((line, index) => 
                    `${index + 1}. ${line.trim()}`
                ).join('\n');
            }
            
            // AI: Enhance recommendations section
            let enhancedRecommendations = data.recommendations || '';
            if (enhancedRecommendations) {
                const recommendationsLines = enhancedRecommendations.split('\n').filter(line => line.trim());
                enhancedRecommendations = recommendationsLines.map((line, index) => 
                    `${index + 1}. ${line.trim()}`
                ).join('\n');
            } else {
                // AI: Generate smart recommendations based on data
                const autoRecommendations = [];
                if (attendanceRate < 90) {
                    autoRecommendations.push('ุชุนุฒูุฒ ุงูุชูุงุตู ุงููุณุจู ูุน ุงููุดุงุฑููู ูุถูุงู ุงูุงูุชุฒุงู ุจุงูุญุถูุฑ');
                }
                if (data.trainingVenueRating === 'ููุจูู' || data.trainingVenueRating === 'ูุญุชุงุฌ ุชุญุณูู') {
                    autoRecommendations.push('ุงูุจุญุซ ุนู ููุฑุงุช ุชุฏุฑูุจูุฉ ุจุฏููุฉ ุฐุงุช ููุงุตูุงุช ุฃุนูู ููุฏูุฑุงุช ุงููุงุฏูุฉ');
                }
                if (parseInt(data.trainerCount) === 1 && parseInt(data.participantCount) > 20) {
                    autoRecommendations.push('ุงููุธุฑ ูู ุฅุถุงูุฉ ูุฏุฑุจ ูุณุงุนุฏ ููุฏูุฑุงุช ุฐุงุช ุงูุฃุนุฏุงุฏ ุงููุจูุฑุฉ ูุชุญุณูู ุงูุชูุงุนู');
                }
                if (workingDays > 10) {
                    autoRecommendations.push('ุชูููู ุฅููุงููุฉ ุชูุณูู ุงูุฏูุฑุงุช ุงูุทูููุฉ ุฅูู ูุฑุงุญู ูุชุญุณูู ุงุณุชูุนุงุจ ุงููุญุชูู');
                }
                if (autoRecommendations.length > 0) {
                    enhancedRecommendations = autoRecommendations.map((rec, index) => 
                        `${index + 1}. ${rec}`
                    ).join('\n');
                }
            }
            
            // AI: Generate executive summary
            const executiveSummary = `ุชู ุจูุฌุงุญ ุงูุชุชุงุญ ุงูุฏูุฑุฉ ุงูุชุฏุฑูุจูุฉ "${data.courseTitle}" ูู ูุฏููุฉ ${data.city} ุจุญุถูุฑ ${data.actualAttendance} ูุชุฏุฑุจุงู ูู ุฃุตู ${data.participantCount} ูุณุฌููู (ูุณุจุฉ ${attendanceRate}%). ูุดุฑู ุนูู ุงูุฏูุฑุฉ ${data.supervisorName} ุจูุดุงุฑูุฉ ${data.trainerCount} ${parseInt(data.trainerCount) > 1 ? 'ูุฏุฑุจูู' : 'ูุฏุฑุจ'}ุ ูุชุณุชูุฑ ููุฏุฉ ${workingDays} ${workingDays > 10 ? 'ููู ุนูู' : workingDays > 2 ? 'ุฃูุงู ุนูู' : 'ูููู ุนูู'}. ุชู ุชูููู ููุฑ ุงูุชุฏุฑูุจ ุจู "${data.trainingVenueRating}"ุ ูุงูุจูุฆุฉ ุงูุชุฏุฑูุจูุฉ ุจุดูู ุนุงู ${data.trainingEnvironment.includes('ููุชุงุฒ') ? 'ููุชุงุฒุฉ' : data.trainingEnvironment.includes('ุฌูุฏ') ? 'ุฌูุฏุฉ' : 'ููุงุณุจุฉ'}.`;
            
            const interpreterSection = data.interpreterCount && parseInt(data.interpreterCount) > 0
                ? `<tr><td style="padding: 12px; border: 1px solid #ddd; background-color: #f9fafb; font-weight: 600; width: 35%;">ุนุฏุฏ ุงููุชุฑุฌููู</td><td style="padding: 12px; border: 1px solid #ddd;">${data.interpreterCount}</td></tr>`
                : '';
            
            let report = `
            <div style="font-family: 'Cairo', sans-serif; line-height: 1.8; direction: rtl; color: #1f2937;">
                
                <!-- Header -->
                <div style="text-align: center; margin-bottom: 30px; padding: 20px; background: linear-gradient(135deg, #166764 0%, #0f4c49 100%); color: white; border-radius: 10px;">
                    <h1 style="font-size: 28px; font-weight: bold; margin: 0 0 10px 0;">ุชูุฑูุฑ ุงูุชุชุงุญ ุฏูุฑุฉ ุชุฏุฑูุจูุฉ</h1>
                    <p style="font-size: 16px; margin: 0; opacity: 0.9;">ููุงูุฉ ุงูุฌุงูุนุฉ ููุชุฏุฑูุจ - ุฅุฏุงุฑุฉ ุนูููุงุช ุงูุชุฏุฑูุจ</p>
                </div>
                
                <!-- Executive Summary -->
                <div style="background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%); padding: 20px; border-right: 4px solid #2563eb; margin-bottom: 25px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                    <h3 style="color: #1e40af; font-size: 18px; font-weight: bold; margin: 0 0 12px 0; display: flex; align-items: center;">
                        <span style="font-size: 24px; margin-left: 8px;">๐</span>
                        ุงูููุฎุต ุงูุชูููุฐู
                    </h3>
                    <p style="margin: 0; font-size: 15px; line-height: 1.9; color: #1e3a8a;">
                        ${executiveSummary}
                    </p>
                </div>
                
                <!-- Introduction -->
                <div style="background-color: #f0f4f3; padding: 20px; border-right: 4px solid #166764; margin-bottom: 25px; border-radius: 5px;">
                    <p style="margin: 0; font-size: 16px; line-height: 1.9;">
                        <strong>ุณุนุงุฏุฉ ูููู ุงูุฌุงูุนุฉ ููุชุฏุฑูุจ โ ุณูููู ุงููู</strong><br><br>
                        ุงูุณูุงู ุนูููู ูุฑุญูุฉ ุงููู ูุจุฑูุงุชูุ<br>
                        ุชุญูุฉ ุทูุจุฉ ูุจุนุฏุุ<br><br>
                        ูููุฏ ุณุนุงุฏุชูู ุจุฃูู ุชู โ ุจูุถู ุงููู โ ุงูุชุชุงุญ ุงูุฏูุฑุฉ ุงูุชุฏุฑูุจูุฉ ุงูุฎุงุฑุฌูุฉ: <strong>"${data.courseTitle}"</strong>ุ 
                        ูุงูููุนูุฏุฉ ูู ูุฏููุฉ <strong>${data.city}</strong>ุ ูุฐูู ุถูู ุงูุฎุทุฉ ุงูุชูููุฐูุฉ ุงููุนุชูุฏุฉ ููุจุฑุงูุฌ ุงูุฎุงุฑุฌูุฉ ููุฐุง ุงูุนุงู.<br><br>
                        ููุฏ ุจุงุดุฑ ูุฑูู ุฅุฏุงุฑุฉ ุนูููุงุช ุงูุชุฏุฑูุจ ุงูุฅุดุฑุงู ุงูููุฏุงูู ุนูู ุงูุทูุงู ุงูุจุฑูุงูุฌุ ูุชู ุงูุชุญูู ูู ุฌุงูุฒูุฉ ุงููุงุนุฉ ุงูุชุฏุฑูุจูุฉุ 
                        ูุณูุงูุฉ ุงูุชุฑุชูุจุงุช ุงูุชูุธูููุฉุ ูุงุณุชูุจุงู ุงููุดุงุฑููู ุจูุง ูููู ุจููุงูุฉ ุงูุฌุงูุนุฉ ูุฑุณุงูุชูุง ุงูุชุฏุฑูุจูุฉ.
                    </p>
                </div>
                
                <!-- Main Information Table -->
                <div style="margin-bottom: 25px;">
                    <h3 style="color: #166764; font-size: 20px; font-weight: bold; margin-bottom: 15px; padding-bottom: 10px; border-bottom: 2px solid #cdb081;">
                        ๐ ุงููุนูููุงุช ุงูุฃุณุงุณูุฉ ููุฏูุฑุฉ
                    </h3>
                    <table style="width: 100%; border-collapse: collapse; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                        <tr>
                            <td style="padding: 12px; border: 1px solid #ddd; background-color: #f9fafb; font-weight: 600; width: 35%;">ุงุณู ุงูุฏูุฑุฉ ุงูุชุฏุฑูุจูุฉ</td>
                            <td style="padding: 12px; border: 1px solid #ddd;">${data.courseTitle}</td>
                        </tr>
                        <tr>
                            <td style="padding: 12px; border: 1px solid #ddd; background-color: #f9fafb; font-weight: 600;">ููุงู ุงูุงูุนูุงุฏ</td>
                            <td style="padding: 12px; border: 1px solid #ddd;">${data.city}</td>
                        </tr>
                        <tr>
                            <td style="padding: 12px; border: 1px solid #ddd; background-color: #f9fafb; font-weight: 600;">ูุชุฑุฉ ุงูุชูููุฐ</td>
                            <td style="padding: 12px; border: 1px solid #ddd;">${coursePeriod} ${workingDays > 0 ? `(${workingDays} ุฃูุงู ุนูู)` : ''}</td>
                        </tr>
                        <tr>
                            <td style="padding: 12px; border: 1px solid #ddd; background-color: #f9fafb; font-weight: 600;">ุงููุดุฑู ุงูููุฏุงูู</td>
                            <td style="padding: 12px; border: 1px solid #ddd;">${data.supervisorName}</td>
                        </tr>
                    </table>
                </div>
                
                <!-- Participants Statistics -->
                <div style="margin-bottom: 25px;">
                    <h3 style="color: #166764; font-size: 20px; font-weight: bold; margin-bottom: 15px; padding-bottom: 10px; border-bottom: 2px solid #cdb081;">
                        ๐ฅ ุฅุญุตุงุฆูุงุช ุงููุดุงุฑูุฉ
                    </h3>
                    <table style="width: 100%; border-collapse: collapse; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                        <tr>
                            <td style="padding: 12px; border: 1px solid #ddd; background-color: #f9fafb; font-weight: 600; width: 35%;">ุนุฏุฏ ุงููุดุงุฑููู ุงููุณุฌููู</td>
                            <td style="padding: 12px; border: 1px solid #ddd;">${data.participantCount}</td>
                        </tr>
                        <tr>
                            <td style="padding: 12px; border: 1px solid #ddd; background-color: #f9fafb; font-weight: 600;">ุนุฏุฏ ุงูุญุถูุฑ ุงููุนูู</td>
                            <td style="padding: 12px; border: 1px solid #ddd;"><strong style="color: #059669;">${data.actualAttendance}</strong></td>
                        </tr>
                        <tr>
                            <td style="padding: 12px; border: 1px solid #ddd; background-color: #f9fafb; font-weight: 600;">ูุณุจุฉ ุงูุญุถูุฑ</td>
                            <td style="padding: 12px; border: 1px solid #ddd;">
                                <strong style="color: ${attendanceRate >= 95 ? '#059669' : attendanceRate >= 85 ? '#0891b2' : attendanceRate >= 75 ? '#f59e0b' : '#dc2626'};">${attendanceRate}%</strong>
                                <br><span style="font-size: 13px; color: #6b7280; font-style: italic;">${attendanceAnalysis}</span>
                            </td>
                        </tr>
                        <tr>
                            <td style="padding: 12px; border: 1px solid #ddd; background-color: #f9fafb; font-weight: 600;">ุนุฏุฏ ุงููุฏุฑุจูู</td>
                            <td style="padding: 12px; border: 1px solid #ddd;">${data.trainerCount}</td>
                        </tr>
                        ${interpreterSection}
                    </table>
                </div>
                
                <!-- Facilities Assessment -->
                <div style="margin-bottom: 25px;">
                    <h3 style="color: #166764; font-size: 20px; font-weight: bold; margin-bottom: 15px; padding-bottom: 10px; border-bottom: 2px solid #cdb081;">
                        ๐ข ุชูููู ุงููุฑุงูู ูุงูุฎุฏูุงุช
                    </h3>
                    <table style="width: 100%; border-collapse: collapse; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                        <tr>
                            <td style="padding: 12px; border: 1px solid #ddd; background-color: #f9fafb; font-weight: 600; width: 35%;">ุงูุจูุฆุฉ ุงูุชุฏุฑูุจูุฉ</td>
                            <td style="padding: 12px; border: 1px solid #ddd;">${data.trainingEnvironment}</td>
                        </tr>
                        <tr>
                            <td style="padding: 12px; border: 1px solid #ddd; background-color: #f9fafb; font-weight: 600;">ุชูููู ููุฑ ุงูุชุฏุฑูุจ</td>
                            <td style="padding: 12px; border: 1px solid #ddd;">
                                <strong style="color: ${data.trainingVenueRating === 'ููุชุงุฒ' ? '#059669' : data.trainingVenueRating === 'ุฌูุฏ ุฌุฏุงู' ? '#0891b2' : data.trainingVenueRating === 'ุฌูุฏ' ? '#f59e0b' : '#dc2626'};">
                                    ${data.trainingVenueRating}
                                </strong>
                            </td>
                        </tr>
                        <tr>
                            <td style="padding: 12px; border: 1px solid #ddd; background-color: #f9fafb; font-weight: 600;">ุงูุชุฌููุฒุงุช ุงูููุฌุณุชูุฉ</td>
                            <td style="padding: 12px; border: 1px solid #ddd;">${data.logisticsPreparation}</td>
                        </tr>
                    </table>
                </div>
                
                <!-- Positives Section -->
                ${enhancedPositives ? `
                <div style="margin-bottom: 25px; background-color: #ecfdf5; padding: 20px; border-right: 4px solid #059669; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                    <h3 style="color: #059669; font-size: 18px; font-weight: bold; margin: 0 0 15px 0; display: flex; align-items: center;">
                        <span style="font-size: 24px; margin-left: 8px;">โ</span>
                        ุงูุฅูุฌุงุจูุงุช ูุงูููุงุญุธุงุช ุงููููุฒุฉ
                    </h3>
                    <div style="line-height: 2; white-space: pre-line; color: #065f46; font-size: 15px;">${enhancedPositives}</div>
                </div>
                ` : ''}
                
                <!-- Negatives Section -->
                ${enhancedNegatives ? `
                <div style="margin-bottom: 25px; background-color: #fef2f2; padding: 20px; border-right: 4px solid #dc2626; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                    <h3 style="color: #dc2626; font-size: 18px; font-weight: bold; margin: 0 0 15px 0; display: flex; align-items: center;">
                        <span style="font-size: 24px; margin-left: 8px;">โ๏ธ</span>
                        ุงูุณูุจูุงุช ูุงูุชุญุฏูุงุช
                    </h3>
                    <div style="line-height: 2; white-space: pre-line; color: #991b1b; font-size: 15px;">${enhancedNegatives}</div>
                </div>
                ` : ''}
                
                <!-- Recommendations Section -->
                ${enhancedRecommendations ? `
                <div style="margin-bottom: 25px; background-color: #eff6ff; padding: 20px; border-right: 4px solid #2563eb; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                    <h3 style="color: #2563eb; font-size: 18px; font-weight: bold; margin: 0 0 15px 0; display: flex; align-items: center;">
                        <span style="font-size: 24px; margin-left: 8px;">๐ก</span>
                        ุงูุชูุตูุงุช ูุงูููุชุฑุญุงุช
                    </h3>
                    <div style="line-height: 2; white-space: pre-line; color: #1e40af; font-size: 15px;">${enhancedRecommendations}</div>
                </div>
                ` : ''}
                
                <!-- Conclusion -->
                <div style="background-color: #f0f4f3; padding: 20px; border-right: 4px solid #cdb081; margin-top: 30px; border-radius: 5px;">
                    <p style="margin: 0; font-size: 16px; line-height: 1.9;">
                        ูุคูุฏ ูุณุนุงุฏุชูู ุงุณุชูุฑุงุฑ ุงููุชุงุจุนุฉ ุงูููุฏุงููุฉ ุงูููููุฉ ุญุชู ุฎุชุงู ุงูุจุฑูุงูุฌุ ูุงูุฑูุน ุจุฃู ูุณุชุฌุฏุงุช ุฃู ููุงุญุธุงุช ุชูููุฐูุฉ ุฃููุงู ุจุฃูู. 
                        ููุง ูุคูุฏ ุงูุชุฒุงููุง ุจุชุทุจูู ุฃุนูู ูุนุงููุฑ ุงูุฌูุฏุฉ ูู ุงูุฅุดุฑุงู ูุงููุชุงุจุนุฉ ูุถูุงู ุชุญููู ุงูุฃูุฏุงู ุงูุชุฏุฑูุจูุฉ ุงููุฑุฌูุฉ.<br><br>
                        <strong>ูุชูุถููุง ุจูุจูู ูุงุฆู ุงูุงุญุชุฑุงู ูุงูุชูุฏูุฑุุุ</strong><br><br>
                        ูุฑูู ุนูู ุฅุฏุงุฑุฉ ุนูููุงุช ุงูุชุฏุฑูุจ<br>
                        ููุงูุฉ ุงูุฌุงูุนุฉ ููุชุฏุฑูุจ<br>
                        ุงูุชุงุฑูุฎ: ${new Date().toLocaleDateString('ar', { year: 'numeric', month: 'numeric', day: 'numeric' })}
                    </p>
                </div>
                
            </div>
            `;
            
            return report;
        }
        
        function generateCourseClosingReport(data) {
            const startDate = data.startDate ? new Date(data.startDate).toLocaleDateString('ar', { year: 'numeric', month: 'numeric', day: 'numeric' }) : '';
            const endDate = data.endDate ? new Date(data.endDate).toLocaleDateString('ar', { year: 'numeric', month: 'numeric', day: 'numeric' }) : '';
            const coursePeriod = startDate && endDate ? `${startDate} - ${endDate}` : '';
            
            // Calculate working days
            let workingDays = 0;
            if (data.startDate && data.endDate) {
                const start = new Date(data.startDate);
                const end = new Date(data.endDate);
                let current = new Date(start);
                while (current <= end) {
                    const dayOfWeek = current.getDay();
                    if (dayOfWeek >= 0 && dayOfWeek <= 4) {
                        workingDays++;
                    }
                    current.setDate(current.getDate() + 1);
                }
            }
            
            // Calculate completion rate
            const completionRate = data.participantCount && data.completedCount 
                ? ((data.completedCount / data.participantCount) * 100).toFixed(1) 
                : '100';
            
            // AI: Generate completion analysis
            let completionAnalysis = '';
            if (completionRate >= 95) {
                completionAnalysis = 'ูุณุจุฉ ุฅุชูุงู ููุชุงุฒุฉ ุชุนูุณ ุงูุชุฒุงู ุงููุชุฏุฑุจูู ูุฌูุฏุฉ ุงูุจุฑูุงูุฌ ุงูุชุฏุฑูุจู';
            } else if (completionRate >= 85) {
                completionAnalysis = 'ูุณุจุฉ ุฅุชูุงู ุฌูุฏุฉ ุฌุฏุงู ูุน ูุฌูุฏ ุจุนุถ ุงูุงูุณุญุงุจุงุช ุงููุจุฑุฑุฉ';
            } else if (completionRate >= 75) {
                completionAnalysis = 'ูุณุจุฉ ุฅุชูุงู ููุจููุฉุ ูููุตุญ ุจุฏุฑุงุณุฉ ุฃุณุจุงุจ ุนุฏู ุงูุฅููุงู';
            } else {
                completionAnalysis = 'ูุณุจุฉ ุฅุชูุงู ุชุญุชุงุฌ ุฅูู ุชุญุณููุ ูููุตู ุจูุฑุงุฌุนุฉ ุงูุนูุงูู ุงููุคุซุฑุฉ';
            }
            
            // AI: Enhance strengths section
            let enhancedStrengths = data.strengths || '';
            if (enhancedStrengths) {
                const strengthsLines = enhancedStrengths.split('\n').filter(line => line.trim());
                enhancedStrengths = strengthsLines.map((line, index) => 
                    `${index + 1}. ${line.trim()}`
                ).join('\n');
            }
            
            // AI: Enhance weaknesses section
            let enhancedWeaknesses = data.weaknesses || '';
            if (enhancedWeaknesses) {
                const weaknessesLines = enhancedWeaknesses.split('\n').filter(line => line.trim());
                enhancedWeaknesses = weaknessesLines.map((line, index) => 
                    `${index + 1}. ${line.trim()}`
                ).join('\n');
            }
            
            // AI: Enhance recommendations section
            let enhancedRecommendations = data.recommendations || '';
            if (enhancedRecommendations) {
                const recommendationsLines = enhancedRecommendations.split('\n').filter(line => line.trim());
                enhancedRecommendations = recommendationsLines.map((line, index) => 
                    `${index + 1}. ${line.trim()}`
                ).join('\n');
            } else {
                // AI: Generate smart recommendations based on data
                const autoRecommendations = [];
                if (completionRate < 90) {
                    autoRecommendations.push('ุฏุฑุงุณุฉ ุฃุณุจุงุจ ุนุฏู ุฅููุงู ุจุนุถ ุงููุชุฏุฑุจูู ูุงุชุฎุงุฐ ุงูุฅุฌุฑุงุกุงุช ุงูููุงุฆูุฉ ูู ุงูุฏูุฑุงุช ุงููุงุฏูุฉ');
                }
                if (data.overallRating === 'ููุจูู' || data.overallRating === 'ูุญุชุงุฌ ุชุญุณูู') {
                    autoRecommendations.push('ูุฑุงุฌุนุฉ ุดุงููุฉ ูููุญุชูู ุงูุชุฏุฑูุจู ูุฃุณุงููุจ ุงูุชุฏุฑูุจ ุงููุณุชุฎุฏูุฉ');
                }
                if (parseInt(data.participantSatisfaction) < 80) {
                    autoRecommendations.push('ุฅุฌุฑุงุก ููุงุจูุงุช ูุฑุฏูุฉ ูุน ุงููุชุฏุฑุจูู ูููู ููุงุท ุนุฏู ุงูุฑุถุง ุจุดูู ุฃุนูู');
                }
                if (workingDays > 10) {
                    autoRecommendations.push('ุงููุธุฑ ูู ุชูุณูู ุงูุฏูุฑุงุช ุงูุทูููุฉ ุฅูู ูุณุชููุงุช ูุชุนุฏุฏุฉ');
                }
                if (autoRecommendations.length > 0) {
                    enhancedRecommendations = autoRecommendations.map((rec, index) => 
                        `${index + 1}. ${rec}`
                    ).join('\n');
                }
            }
            
            // AI: Generate executive summary
            const executiveSummary = `ุชู ุจูุฌุงุญ ุงุฎุชุชุงู ุงูุฏูุฑุฉ ุงูุชุฏุฑูุจูุฉ "${data.courseTitle}" ุงูุชู ุฃููููุช ูู ูุฏููุฉ ${data.city} ุฎูุงู ุงููุชุฑุฉ ูู ${startDate} ุฅูู ${endDate} (${workingDays} ${workingDays > 10 ? 'ููู ุนูู' : workingDays > 2 ? 'ุฃูุงู ุนูู' : 'ูููู ุนูู'}). ุฃููู ${data.completedCount} ูุชุฏุฑุจุงู ูู ุฃุตู ${data.participantCount} ูุณุฌููู ุงูุฏูุฑุฉ ุจูุฌุงุญ (ูุณุจุฉ ${completionRate}%). ุจูุบุช ูุณุจุฉ ุฑุถุง ุงููุชุฏุฑุจูู ${data.participantSatisfaction}%ุ ูุชู ุชูููู ุงูุฏูุฑุฉ ุจุดูู ุนุงู ุจู "${data.overallRating}". ุฃุดุฑู ุนูู ุงูุฏูุฑุฉ ${data.supervisorName} ุจูุดุงุฑูุฉ ${data.trainerCount} ${parseInt(data.trainerCount) > 1 ? 'ูุฏุฑุจูู' : 'ูุฏุฑุจ'}.`;
            
            let report = `
            <div style="font-family: 'Cairo', sans-serif; line-height: 1.8; direction: rtl; color: #1f2937;">
                
                <!-- Header -->
                <div style="text-align: center; margin-bottom: 30px; padding: 20px; background: linear-gradient(135deg, #059669 0%, #047857 100%); color: white; border-radius: 10px;">
                    <h1 style="font-size: 28px; font-weight: bold; margin: 0 0 10px 0;">ุชูุฑูุฑ ุงุฎุชุชุงู ุฏูุฑุฉ ุชุฏุฑูุจูุฉ</h1>
                    <p style="font-size: 16px; margin: 0; opacity: 0.9;">ููุงูุฉ ุงูุฌุงูุนุฉ ููุชุฏุฑูุจ - ุฅุฏุงุฑุฉ ุนูููุงุช ุงูุชุฏุฑูุจ</p>
                </div>
                
                <!-- Executive Summary -->
                <div style="background: linear-gradient(135deg, #ecfdf5 0%, #d1fae5 100%); padding: 20px; border-right: 4px solid #059669; margin-bottom: 25px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                    <h3 style="color: #047857; font-size: 18px; font-weight: bold; margin: 0 0 12px 0; display: flex; align-items: center;">
                        <span style="font-size: 24px; margin-left: 8px;">๐</span>
                        ุงูููุฎุต ุงูุชูููุฐู
                    </h3>
                    <p style="margin: 0; font-size: 15px; line-height: 1.9; color: #065f46;">
                        ${executiveSummary}
                    </p>
                </div>
                
                <!-- Introduction -->
                <div style="background-color: #f0fdf4; padding: 20px; border-right: 4px solid #059669; margin-bottom: 25px; border-radius: 5px;">
                    <p style="margin: 0; font-size: 16px; line-height: 1.9;">
                        <strong>ุณุนุงุฏุฉ ูููู ุงูุฌุงูุนุฉ ููุชุฏุฑูุจ โ ุณูููู ุงููู</strong><br><br>
                        ุงูุณูุงู ุนูููู ูุฑุญูุฉ ุงููู ูุจุฑูุงุชูุ<br>
                        ุชุญูุฉ ุทูุจุฉ ูุจุนุฏุุ<br><br>
                        ูุณุฑูุง ุฃู ูุฑูุน ูุณุนุงุฏุชูู ุชูุฑูุฑ ุงุฎุชุชุงู ุงูุฏูุฑุฉ ุงูุชุฏุฑูุจูุฉ: <strong>"${data.courseTitle}"</strong>ุ 
                        ูุงูุชู ุฃููููุช ูู ูุฏููุฉ <strong>${data.city}</strong> ุฎูุงู ุงููุชุฑุฉ ูู ${startDate} ุฅูู ${endDate}.<br><br>
                        ููุฏ ุชุงุจุน ูุฑูู ุฅุฏุงุฑุฉ ุนูููุงุช ุงูุชุฏุฑูุจ ุณูุฑ ุงูุจุฑูุงูุฌ ุงูุชุฏุฑูุจู ุจุดูู ููููุ ูุชู ุฑุตุฏ ุฌููุน ุงูููุงุญุธุงุช ูุงููุคุดุฑุงุช 
                        ุงูุชู ุชุนูุณ ูุณุชูู ุงูุฃุฏุงุก ูุฌูุฏุฉ ุงูุชูููุฐุ ูุฐูู ูุถูุงู ุชุญููู ุงูุฃูุฏุงู ุงูุชุฏุฑูุจูุฉ ุงููุฑุฌูุฉ.
                    </p>
                </div>
                
                <!-- Main Information Table -->
                <div style="margin-bottom: 25px;">
                    <h3 style="color: #059669; font-size: 20px; font-weight: bold; margin-bottom: 15px; padding-bottom: 10px; border-bottom: 2px solid #86efac;">
                        ๐ ุงููุนูููุงุช ุงูุฃุณุงุณูุฉ ููุฏูุฑุฉ
                    </h3>
                    <table style="width: 100%; border-collapse: collapse; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                        <tr>
                            <td style="padding: 12px; border: 1px solid #ddd; background-color: #f9fafb; font-weight: 600; width: 35%;">ุงุณู ุงูุฏูุฑุฉ ุงูุชุฏุฑูุจูุฉ</td>
                            <td style="padding: 12px; border: 1px solid #ddd;">${data.courseTitle}</td>
                        </tr>
                        <tr>
                            <td style="padding: 12px; border: 1px solid #ddd; background-color: #f9fafb; font-weight: 600;">ููุงู ุงูุงูุนูุงุฏ</td>
                            <td style="padding: 12px; border: 1px solid #ddd;">${data.city}</td>
                        </tr>
                        <tr>
                            <td style="padding: 12px; border: 1px solid #ddd; background-color: #f9fafb; font-weight: 600;">ูุชุฑุฉ ุงูุชูููุฐ</td>
                            <td style="padding: 12px; border: 1px solid #ddd;">${coursePeriod} ${workingDays > 0 ? `(${workingDays} ุฃูุงู ุนูู)` : ''}</td>
                        </tr>
                        <tr>
                            <td style="padding: 12px; border: 1px solid #ddd; background-color: #f9fafb; font-weight: 600;">ุงููุดุฑู ุงูููุฏุงูู</td>
                            <td style="padding: 12px; border: 1px solid #ddd;">${data.supervisorName}</td>
                        </tr>
                        <tr>
                            <td style="padding: 12px; border: 1px solid #ddd; background-color: #f9fafb; font-weight: 600;">ุนุฏุฏ ุงููุฏุฑุจูู</td>
                            <td style="padding: 12px; border: 1px solid #ddd;">${data.trainerCount}</td>
                        </tr>
                    </table>
                </div>
                
                <!-- Completion Statistics -->
                <div style="margin-bottom: 25px;">
                    <h3 style="color: #059669; font-size: 20px; font-weight: bold; margin-bottom: 15px; padding-bottom: 10px; border-bottom: 2px solid #86efac;">
                        ๐ ุฅุญุตุงุฆูุงุช ุงูุฅูุฌุงุฒ
                    </h3>
                    <table style="width: 100%; border-collapse: collapse; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                        <tr>
                            <td style="padding: 12px; border: 1px solid #ddd; background-color: #f9fafb; font-weight: 600; width: 35%;">ุนุฏุฏ ุงููุดุงุฑููู ุงููุณุฌููู</td>
                            <td style="padding: 12px; border: 1px solid #ddd;">${data.participantCount}</td>
                        </tr>
                        <tr>
                            <td style="padding: 12px; border: 1px solid #ddd; background-color: #f9fafb; font-weight: 600;">ุนุฏุฏ ุงููุชุฏุฑุจูู ุงูุฐูู ุฃููููุง ุงูุฏูุฑุฉ</td>
                            <td style="padding: 12px; border: 1px solid #ddd;"><strong style="color: #059669;">${data.completedCount}</strong></td>
                        </tr>
                        <tr>
                            <td style="padding: 12px; border: 1px solid #ddd; background-color: #f9fafb; font-weight: 600;">ูุณุจุฉ ุงูุฅููุงู</td>
                            <td style="padding: 12px; border: 1px solid #ddd;">
                                <strong style="color: ${completionRate >= 95 ? '#059669' : completionRate >= 85 ? '#0891b2' : completionRate >= 75 ? '#f59e0b' : '#dc2626'};">${completionRate}%</strong>
                                <br><span style="font-size: 13px; color: #6b7280; font-style: italic;">${completionAnalysis}</span>
                            </td>
                        </tr>
                        <tr>
                            <td style="padding: 12px; border: 1px solid #ddd; background-color: #f9fafb; font-weight: 600;">ูุณุจุฉ ุฑุถุง ุงููุชุฏุฑุจูู</td>
                            <td style="padding: 12px; border: 1px solid #ddd;">
                                <strong style="color: ${data.participantSatisfaction >= 90 ? '#059669' : data.participantSatisfaction >= 80 ? '#0891b2' : data.participantSatisfaction >= 70 ? '#f59e0b' : '#dc2626'};">${data.participantSatisfaction}%</strong>
                            </td>
                        </tr>
                        <tr>
                            <td style="padding: 12px; border: 1px solid #ddd; background-color: #f9fafb; font-weight: 600;">ุงูุชูููู ุงูุนุงู ููุฏูุฑุฉ</td>
                            <td style="padding: 12px; border: 1px solid #ddd;">
                                <strong style="color: ${data.overallRating === 'ููุชุงุฒ' ? '#059669' : data.overallRating === 'ุฌูุฏ ุฌุฏุงู' ? '#0891b2' : data.overallRating === 'ุฌูุฏ' ? '#f59e0b' : '#dc2626'};">
                                    ${data.overallRating}
                                </strong>
                            </td>
                        </tr>
                    </table>
                </div>
                
                <!-- Objectives Achievement -->
                <div style="margin-bottom: 25px; background-color: #eff6ff; padding: 20px; border-right: 4px solid #2563eb; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                    <h3 style="color: #1e40af; font-size: 18px; font-weight: bold; margin: 0 0 15px 0; display: flex; align-items: center;">
                        <span style="font-size: 24px; margin-left: 8px;">๐ฏ</span>
                        ูุฏู ุชุญููู ุงูุฃูุฏุงู ุงูุชุฏุฑูุจูุฉ
                    </h3>
                    <div style="line-height: 2; white-space: pre-line; color: #1e3a8a; font-size: 15px;">${data.objectivesAchievement}</div>
                </div>
                
                <!-- Strengths Section -->
                ${enhancedStrengths ? `
                <div style="margin-bottom: 25px; background-color: #ecfdf5; padding: 20px; border-right: 4px solid #059669; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                    <h3 style="color: #059669; font-size: 18px; font-weight: bold; margin: 0 0 15px 0; display: flex; align-items: center;">
                        <span style="font-size: 24px; margin-left: 8px;">๐ช</span>
                        ููุงุท ุงูููุฉ
                    </h3>
                    <div style="line-height: 2; white-space: pre-line; color: #065f46; font-size: 15px;">${enhancedStrengths}</div>
                </div>
                ` : ''}
                
                <!-- Weaknesses Section -->
                ${enhancedWeaknesses ? `
                <div style="margin-bottom: 25px; background-color: #fef2f2; padding: 20px; border-right: 4px solid #dc2626; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                    <h3 style="color: #dc2626; font-size: 18px; font-weight: bold; margin: 0 0 15px 0; display: flex; align-items: center;">
                        <span style="font-size: 24px; margin-left: 8px;">โ๏ธ</span>
                        ููุงุท ุงูุถุนู ูุงูุชุญุฏูุงุช
                    </h3>
                    <div style="line-height: 2; white-space: pre-line; color: #991b1b; font-size: 15px;">${enhancedWeaknesses}</div>
                </div>
                ` : ''}
                
                <!-- Recommendations Section -->
                ${enhancedRecommendations ? `
                <div style="margin-bottom: 25px; background-color: #eff6ff; padding: 20px; border-right: 4px solid #2563eb; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                    <h3 style="color: #2563eb; font-size: 18px; font-weight: bold; margin: 0 0 15px 0; display: flex; align-items: center;">
                        <span style="font-size: 24px; margin-left: 8px;">๐ก</span>
                        ุงูุชูุตูุงุช ูุงูููุชุฑุญุงุช
                    </h3>
                    <div style="line-height: 2; white-space: pre-line; color: #1e40af; font-size: 15px;">${enhancedRecommendations}</div>
                </div>
                ` : ''}
                
                <!-- Certificates Section -->
                ${data.certificates ? `
                <div style="margin-bottom: 25px; background-color: #fef3c7; padding: 20px; border-right: 4px solid #f59e0b; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                    <h3 style="color: #d97706; font-size: 18px; font-weight: bold; margin: 0 0 15px 0; display: flex; align-items: center;">
                        <span style="font-size: 24px; margin-left: 8px;">๐</span>
                        ุงูุดูุงุฏุงุช ูุงูุชูุฑูู
                    </h3>
                    <div style="line-height: 2; white-space: pre-line; color: #92400e; font-size: 15px;">${data.certificates}</div>
                </div>
                ` : ''}
                
                <!-- Conclusion -->
                <div style="background-color: #f0fdf4; padding: 20px; border-right: 4px solid #86efac; margin-top: 30px; border-radius: 5px;">
                    <p style="margin: 0; font-size: 16px; line-height: 1.9;">
                        ูู ุงูุฎุชุงูุ ูุคูุฏ ูุณุนุงุฏุชูู ุฃู ุงูุฏูุฑุฉ ุญููุช ุฃูุฏุงููุง ุงูุชุฏุฑูุจูุฉ ุจูุฌุงุญุ ูุฃู ุงููุชุฏุฑุจูู ุฃุจุฏูุง ุฑุถุงูู ุนู ูุณุชูู ุงูุชูุธูู ูุงููุญุชูู ุงูุชุฏุฑูุจู. 
                        ูุณูุนูู ุนูู ุชุทุจูู ุงูุชูุตูุงุช ุงููุฐููุฑุฉ ูู ุงูุฏูุฑุงุช ุงููุงุฏูุฉ ูุชุญุณูู ูุณุชูู ุงูุฃุฏุงุก ุจุดูู ูุณุชูุฑ.<br><br>
                        ูุดูุฑ ูุณุนุงุฏุชูู ุฏุนููู ุงููุชูุงุตูุ ููุชุทูุน ุฅูู ูุฒูุฏ ูู ุงูุชููุฒ ูู ุจุฑุงูุฌูุง ุงูุชุฏุฑูุจูุฉ ุงููุงุฏูุฉ.<br><br>
                        <strong>ูุชูุถููุง ุจูุจูู ูุงุฆู ุงูุงุญุชุฑุงู ูุงูุชูุฏูุฑุุุ</strong><br><br>
                        ูุฑูู ุนูู ุฅุฏุงุฑุฉ ุนูููุงุช ุงูุชุฏุฑูุจ<br>
                        ููุงูุฉ ุงูุฌุงูุนุฉ ููุชุฏุฑูุจ<br>
                        ุงูุชุงุฑูุฎ: ${new Date().toLocaleDateString('ar', { year: 'numeric', month: 'numeric', day: 'numeric' })}
                    </p>
                </div>
                
            </div>
            `;
            
            return report;
        }

        function goBack() {
            document.getElementById('letterTypeSection').classList.add('hidden');
            document.getElementById('categorySelection').classList.remove('hidden');
        }

        function createNewLetter() {
            document.getElementById('letterOutput').classList.add('hidden');
            document.getElementById('categorySelection').classList.remove('hidden');
            currentLetterContent = '';
        }

        function toggleEditMode() {
            const display = document.getElementById('letterDisplay');
            const editor = document.getElementById('letterEditor');
            const textarea = document.getElementById('letterTextEditor');
            const button = document.getElementById('editToggle');
            
            if (editor.classList.contains('hidden')) {
                textarea.value = display.innerText;
                display.classList.add('hidden');
                editor.classList.remove('hidden');
                button.textContent = 'ุฅูุบุงุก ุงูุชุนุฏูู';
            } else {
                display.classList.remove('hidden');
                editor.classList.add('hidden');
                button.textContent = 'ุชุนุฏูู';
            }
        }

        function saveEdits() {
            const textarea = document.getElementById('letterTextEditor');
            const display = document.getElementById('letterDisplay');
            
            const editedText = textarea.value.split('\n').map(line => `<p>${line}</p>`).join('');
            display.innerHTML = editedText;
            currentLetterContent = editedText;
            
            toggleEditMode();
        }

        function cancelEdits() {
            toggleEditMode();
        }

        function copyLetter() {
            const display = document.getElementById('letterDisplay');
            const text = display.innerText;
            
            navigator.clipboard.writeText(text).then(() => {
                alert('ุชู ูุณุฎ ุงููุฑุงุณูุฉ ุจูุฌุงุญ!');
            });
        }

        function exportToWord() {
            const display = document.getElementById('letterDisplay');
            const content = display.innerHTML;
            
            const blob = new Blob(['\ufeff', content], {
                type: 'application/msword'
            });
            
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `ูุฑุงุณูุฉ_${new Date().getTime()}.doc`;
            link.click();
        }



        function saveToArchive() {
            const template = letterTemplates[currentCategory][currentLetterType];
            
            const archiveItem = {
                id: Date.now(),
                category: currentCategory,
                type: currentLetterType,
                title: template.title,
                content: currentLetterContent,
                date: new Date().toISOString(),
                dateFormatted: new Date().toLocaleDateString('ar', { year: 'numeric', month: 'numeric', day: 'numeric' })
            };
            
            archiveData.push(archiveItem);
            localStorage.setItem('archiveData', JSON.stringify(archiveData));
            
            alert('ุชู ุญูุธ ุงููุฑุงุณูุฉ ูู ุงูุฃุฑุดูู ุจูุฌุงุญ!');
        }

        function openArchive() {
            document.getElementById('archiveModal').classList.remove('hidden');
            loadArchive();
        }

        function closeArchive() {
            document.getElementById('archiveModal').classList.add('hidden');
        }

        function loadArchive() {
            updateStatistics();
            displayArchiveItems(archiveData);
        }

        function updateStatistics() {
            const total = archiveData.length;
            const currentMonth = new Date().getMonth();
            const monthly = archiveData.filter(item => new Date(item.date).getMonth() === currentMonth).length;
            const internal = archiveData.filter(item => item.category === 'internal').length;
            const external = archiveData.filter(item => item.category === 'external').length;
            
            document.getElementById('totalTransactions').textContent = total;
            document.getElementById('monthlyTransactions').textContent = monthly;
            document.getElementById('internalTransactions').textContent = internal;
            document.getElementById('externalTransactions').textContent = external;
        }

        function displayArchiveItems(items) {
            const archiveList = document.getElementById('archiveList');
            
            if (items.length === 0) {
                archiveList.innerHTML = `
                    <div class="text-center text-gray-500 py-8">
                        <svg class="w-16 h-16 mx-auto mb-4 text-gray-300" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M3 4h18v2H3V4zm0 7h18v9a2 2 0 01-2 2H5a2 2 0 01-2-2v-9zm2 2v7h14v-7H5zm2 2h10v1H7v-1zm0 2h7v1H7v-1z"/>
                        </svg>
                        <p class="text-lg">ูุง ุชูุฌุฏ ูุนุงููุงุช ูุญููุธุฉ</p>
                    </div>
                `;
                return;
            }
            
            archiveList.innerHTML = items.map(item => `
                <div class="bg-white border border-gray-200 rounded-lg p-4 hover:shadow-lg transition-shadow">
                    <div class="flex items-center justify-between">
                        <div class="flex-1">
                            <h4 class="font-bold text-lg text-nauss-green mb-2">${item.title}</h4>
                            <div class="flex items-center gap-4 text-sm text-gray-600">
                                <span class="flex items-center">
                                    <svg class="w-4 h-4 ml-1" fill="currentColor" viewBox="0 0 24 24">
                                        <path d="M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"/>
                                    </svg>
                                    ${item.dateFormatted}
                                </span>
                                <span class="px-2 py-1 rounded-full text-xs ${item.category === 'internal' ? 'bg-purple-100 text-purple-700' : 'bg-orange-100 text-orange-700'}">
                                    ${item.category === 'internal' ? 'ุฏุงุฎููุฉ' : 'ุฎุงุฑุฌูุฉ'}
                                </span>
                            </div>
                        </div>
                        <div class="flex gap-2">
                            <button onclick="viewArchiveItem(${item.id})" class="bg-blue-500 hover:bg-blue-600 text-white px-3 py-2 rounded-lg text-sm transition-colors">
                                ุนุฑุถ
                            </button>
                            <button onclick="deleteArchiveItem(${item.id})" class="bg-red-500 hover:bg-red-600 text-white px-3 py-2 rounded-lg text-sm transition-colors">
                                ุญุฐู
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function viewArchiveItem(id) {
            const item = archiveData.find(i => i.id === id);
            if (item) {
                currentLetterContent = item.content;
                document.getElementById('letterDisplay').innerHTML = item.content;
                closeArchive();
                document.getElementById('categorySelection').classList.add('hidden');
                document.getElementById('letterOutput').classList.remove('hidden');
            }
        }

        function deleteArchiveItem(id) {
            if (confirm('ูู ุฃูุช ูุชุฃูุฏ ูู ุญุฐู ูุฐู ุงููุนุงููุฉุ')) {
                archiveData = archiveData.filter(item => item.id !== id);
                localStorage.setItem('archiveData', JSON.stringify(archiveData));
                loadArchive();
            }
        }

        function filterArchive() {
            const searchTerm = document.getElementById('archiveSearch').value.toLowerCase();
            const typeFilter = document.getElementById('archiveTypeFilter').value;
            const dateFrom = document.getElementById('archiveDateFrom').value;
            const dateTo = document.getElementById('archiveDateTo').value;
            
            let filtered = archiveData;
            
            if (searchTerm) {
                filtered = filtered.filter(item => 
                    item.title.toLowerCase().includes(searchTerm) ||
                    item.content.toLowerCase().includes(searchTerm)
                );
            }
            
            if (typeFilter) {
                filtered = filtered.filter(item => item.category === typeFilter);
            }
            
            if (dateFrom) {
                filtered = filtered.filter(item => new Date(item.date) >= new Date(dateFrom));
            }
            
            if (dateTo) {
                filtered = filtered.filter(item => new Date(item.date) <= new Date(dateTo));
            }
            
            displayArchiveItems(filtered);
        }

        function clearArchiveFilters() {
            document.getElementById('archiveSearch').value = '';
            document.getElementById('archiveTypeFilter').value = '';
            document.getElementById('archiveDateFrom').value = '';
            document.getElementById('archiveDateTo').value = '';
            displayArchiveItems(archiveData);
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            loadArchive();
        });
    </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'99d10fff25d46ae7',t:'MTc2Mjg5ODQyNi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>